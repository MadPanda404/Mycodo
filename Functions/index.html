<!doctype html><html lang=en class=no-js> <head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="Mycodo Documentation"><meta name=author content="Kyle T. Gabriel"><link href=https://kizniche.github.io/Mycodo/Functions/ rel=canonical><link href=../Outputs/ rel=prev><link href=../Actions/ rel=next><link rel=icon href=../images/favicon.png><meta name=generator content="mkdocs-1.6.1, mkdocs-material-9.5.39"><title>Functions - Mycodo</title><link rel=stylesheet href=../assets/stylesheets/main.8c3ca2c6.min.css><link rel=stylesheet href=../assets/stylesheets/palette.06af60db.min.css><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Barlow:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback"><style>:root{--md-text-font:"Barlow";--md-code-font:"Roboto Mono"}</style><link rel=stylesheet href=../css/hide_lang_links.css><script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script></head> <body dir=ltr data-md-color-scheme=preference data-md-color-primary=blue data-md-color-accent=indigo> <input class=md-toggle data-md-toggle=drawer type=checkbox id=__drawer autocomplete=off> <input class=md-toggle data-md-toggle=search type=checkbox id=__search autocomplete=off> <label class=md-overlay for=__drawer></label> <div data-md-component=skip> <a href=#custom-functions class=md-skip> Skip to content </a> </div> <div data-md-component=announce> </div> <div data-md-color-scheme=default data-md-component=outdated hidden> </div> <header class=md-header data-md-component=header> <nav class="md-header__inner md-grid" aria-label=Header> <a href=.. title=Mycodo class="md-header__button md-logo" aria-label=Mycodo data-md-component=logo> <img src=../images/favicon.png alt=logo> </a> <label class="md-header__button md-icon" for=__drawer> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg> </label> <div class=md-header__title data-md-component=header-title> <div class=md-header__ellipsis> <div class=md-header__topic> <span class=md-ellipsis> Mycodo </span> </div> <div class=md-header__topic data-md-component=header-topic> <span class=md-ellipsis> Functions </span> </div> </div> </div> <form class=md-header__option data-md-component=palette> <input class=md-option data-md-color-media data-md-color-scheme=preference data-md-color-primary=blue data-md-color-accent=indigo aria-label="Switch to dark mode" type=radio name=__palette id=__palette_0> <label class="md-header__button md-icon" title="Switch to dark mode" for=__palette_1 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M17 6H7c-3.31 0-6 2.69-6 6s2.69 6 6 6h10c3.31 0 6-2.69 6-6s-2.69-6-6-6m0 10H7c-2.21 0-4-1.79-4-4s1.79-4 4-4h10c2.21 0 4 1.79 4 4s-1.79 4-4 4M7 9c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3"/></svg> </label> <input class=md-option data-md-color-media data-md-color-scheme=slate data-md-color-primary=red data-md-color-accent=red aria-label="Switch to light mode" type=radio name=__palette id=__palette_1> <label class="md-header__button md-icon" title="Switch to light mode" for=__palette_0 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M17 7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h10a5 5 0 0 0 5-5 5 5 0 0 0-5-5m0 8a3 3 0 0 1-3-3 3 3 0 0 1 3-3 3 3 0 0 1 3 3 3 3 0 0 1-3 3"/></svg> </label> </form> <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script> <div class=md-header__option> <div class=md-select> <button class="md-header__button md-icon" aria-label="Select language"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="m12.87 15.07-2.54-2.51.03-.03A17.5 17.5 0 0 0 14.07 6H17V4h-7V2H8v2H1v2h11.17C11.5 7.92 10.44 9.75 9 11.35 8.07 10.32 7.3 9.19 6.69 8h-2c.73 1.63 1.73 3.17 2.98 4.56l-5.09 5.02L4 19l5-5 3.11 3.11zM18.5 10h-2L12 22h2l1.12-3h4.75L21 22h2zm-2.62 7 1.62-4.33L19.12 17z"/></svg> </button> <div class=md-select__inner> <ul class=md-select__list> <li class=md-select__item> <a href=./ hreflang=en class=md-select__link> English </a> </li> <li class=md-select__item> <a href=../index.de/ hreflang=de class=md-select__link> Deutsche </a> </li> <li class=md-select__item> <a href=../index.es/ hreflang=es class=md-select__link> Español </a> </li> <li class=md-select__item> <a href=../index.fr/ hreflang=fr class=md-select__link> Français </a> </li> <li class=md-select__item> <a href=../index.id/ hreflang=id class=md-select__link> Bahasa Indonesia </a> </li> <li class=md-select__item> <a href=../index.it/ hreflang=it class=md-select__link> Italiano </a> </li> <li class=md-select__item> <a href=../index.nl/ hreflang=nl class=md-select__link> Nederlands </a> </li> <li class=md-select__item> <a href=../index.nn/ hreflang=nn class=md-select__link> Norsk </a> </li> <li class=md-select__item> <a href=../index.pl/ hreflang=pl class=md-select__link> Polski </a> </li> <li class=md-select__item> <a href=../index.pt/ hreflang=pt class=md-select__link> Português </a> </li> <li class=md-select__item> <a href=../index.ru/ hreflang=ru class=md-select__link> русский язык </a> </li> <li class=md-select__item> <a href=../index.sr/ hreflang=sr class=md-select__link> српски </a> </li> <li class=md-select__item> <a href=../index.sv/ hreflang=sv class=md-select__link> Svenska </a> </li> <li class=md-select__item> <a href=../index.tr/ hreflang=tr class=md-select__link> Türkçe </a> </li> <li class=md-select__item> <a href=../index.zh/ hreflang=zh class=md-select__link> 中文 </a> </li> </ul> </div> </div> </div> <label class="md-header__button md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg> </label> <div class=md-search data-md-component=search role=dialog> <label class=md-search__overlay for=__search></label> <div class=md-search__inner role=search> <form class=md-search__form name=search> <input type=text class=md-search__input name=query aria-label=Search placeholder=Search autocapitalize=off autocorrect=off autocomplete=off spellcheck=false data-md-component=search-query required> <label class="md-search__icon md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg> </label> <nav class=md-search__options aria-label=Search> <button type=reset class="md-search__icon md-icon" title=Clear aria-label=Clear tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg> </button> </nav> </form> <div class=md-search__output> <div class=md-search__scrollwrap tabindex=0 data-md-scrollfix> <div class=md-search-result data-md-component=search-result> <div class=md-search-result__meta> Initializing search </div> <ol class=md-search-result__list role=presentation></ol> </div> </div> </div> </div> </div> <div class=md-header__source> <a href=https://github.com/kizniche/Mycodo title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg> </div> <div class=md-source__repository> kizniche/Mycodo </div> </a> </div> </nav> </header> <div class=md-container data-md-component=container> <nav class=md-tabs aria-label=Tabs data-md-component=tabs> <div class=md-grid> <ul class=md-tabs__list> <li class=md-tabs__item> <a href=.. class=md-tabs__link> Home </a> </li> <li class=md-tabs__item> <a href=../About/ class=md-tabs__link> About </a> </li> <li class="md-tabs__item md-tabs__item--active"> <a href=../Data-Viewing/ class=md-tabs__link> Usage </a> </li> <li class=md-tabs__item> <a href=../Supported-Inputs-By-Measurement/ class=md-tabs__link> Supported Devices </a> </li> <li class=md-tabs__item> <a href=../System-Information/ class=md-tabs__link> System </a> </li> <li class=md-tabs__item> <a href=../Troubleshooting/ class=md-tabs__link> Troubleshooting </a> </li> </ul> </div> </nav> <main class=md-main data-md-component=main> <div class="md-main__inner md-grid"> <div class="md-sidebar md-sidebar--primary" data-md-component=sidebar data-md-type=navigation> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--primary md-nav--lifted" aria-label=Navigation data-md-level=0> <label class=md-nav__title for=__drawer> <a href=.. title=Mycodo class="md-nav__button md-logo" aria-label=Mycodo data-md-component=logo> <img src=../images/favicon.png alt=logo> </a> Mycodo </label> <div class=md-nav__source> <a href=https://github.com/kizniche/Mycodo title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg> </div> <div class=md-source__repository> kizniche/Mycodo </div> </a> </div> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=.. class=md-nav__link> <span class=md-ellipsis> Home </span> </a> </li> <li class=md-nav__item> <a href=../About/ class=md-nav__link> <span class=md-ellipsis> About </span> </a> </li> <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_3 checked> <label class=md-nav__link for=__nav_3 id=__nav_3_label tabindex> <span class=md-ellipsis> Usage </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_3_label aria-expanded=true> <label class=md-nav__title for=__nav_3> <span class="md-nav__icon md-icon"></span> Usage </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../Data-Viewing/ class=md-nav__link> <span class=md-ellipsis> Data Viewing </span> </a> </li> <li class=md-nav__item> <a href=../Inputs/ class=md-nav__link> <span class=md-ellipsis> Inputs </span> </a> </li> <li class=md-nav__item> <a href=../Outputs/ class=md-nav__link> <span class=md-ellipsis> Outputs </span> </a> </li> <li class="md-nav__item md-nav__item--active"> <input class="md-nav__toggle md-toggle" type=checkbox id=__toc> <label class="md-nav__link md-nav__link--active" for=__toc> <span class=md-ellipsis> Functions </span> <span class="md-nav__icon md-icon"></span> </label> <a href=./ class="md-nav__link md-nav__link--active"> <span class=md-ellipsis> Functions </span> </a> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#custom-functions class=md-nav__link> <span class=md-ellipsis> Custom Functions </span> </a> </li> <li class=md-nav__item> <a href=#pid-controller class=md-nav__link> <span class=md-ellipsis> PID Controller </span> </a> <nav class=md-nav aria-label="PID Controller"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#pid-controller-options class=md-nav__link> <span class=md-ellipsis> PID Controller Options </span> </a> </li> <li class=md-nav__item> <a href=#pid-output-calculation class=md-nav__link> <span class=md-ellipsis> PID Output Calculation </span> </a> </li> <li class=md-nav__item> <a href=#pid-tuning class=md-nav__link> <span class=md-ellipsis> PID Tuning </span> </a> <nav class=md-nav aria-label="PID Tuning"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#pid-tuning-resources class=md-nav__link> <span class=md-ellipsis> PID Tuning Resources </span> </a> </li> <li class=md-nav__item> <a href=#pid-control-theory class=md-nav__link> <span class=md-ellipsis> PID Control Theory </span> </a> </li> <li class=md-nav__item> <a href=#quick-setup-examples class=md-nav__link> <span class=md-ellipsis> Quick Setup Examples </span> </a> </li> <li class=md-nav__item> <a href=#exact-temperature-regulation class=md-nav__link> <span class=md-ellipsis> Exact Temperature Regulation </span> </a> </li> <li class=md-nav__item> <a href=#high-temperature-regulation class=md-nav__link> <span class=md-ellipsis> High Temperature Regulation </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#pid-autotune class=md-nav__link> <span class=md-ellipsis> PID Autotune </span> </a> </li> <li class=md-nav__item> <a href=#conditional class=md-nav__link> <span class=md-ellipsis> Conditional </span> </a> <nav class=md-nav aria-label=Conditional> <ul class=md-nav__list> <li class=md-nav__item> <a href=#conditional-options class=md-nav__link> <span class=md-ellipsis> Conditional Options </span> </a> </li> <li class=md-nav__item> <a href=#conditional-setup-guide class=md-nav__link> <span class=md-ellipsis> Conditional Setup Guide </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#trigger class=md-nav__link> <span class=md-ellipsis> Trigger </span> </a> <nav class=md-nav aria-label=Trigger> <ul class=md-nav__list> <li class=md-nav__item> <a href=#output-onoff-options class=md-nav__link> <span class=md-ellipsis> Output (On/Off) Options </span> </a> </li> <li class=md-nav__item> <a href=#output-pwm-options class=md-nav__link> <span class=md-ellipsis> Output (PWM) Options </span> </a> </li> <li class=md-nav__item> <a href=#edge-options class=md-nav__link> <span class=md-ellipsis> Edge Options </span> </a> </li> <li class=md-nav__item> <a href=#run-pwm-method-options class=md-nav__link> <span class=md-ellipsis> Run PWM Method Options </span> </a> </li> <li class=md-nav__item> <a href=#sunrisesunset-options class=md-nav__link> <span class=md-ellipsis> Sunrise/Sunset Options </span> </a> </li> <li class=md-nav__item> <a href=#timer-duration-options class=md-nav__link> <span class=md-ellipsis> Timer (Duration) Options </span> </a> </li> <li class=md-nav__item> <a href=#timer-daily-time-point-options class=md-nav__link> <span class=md-ellipsis> Timer (Daily Time Point) Options </span> </a> </li> <li class=md-nav__item> <a href=#timer-daily-time-span-options class=md-nav__link> <span class=md-ellipsis> Timer (Daily Time Span) Options </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../Actions/ class=md-nav__link> <span class=md-ellipsis> Actions </span> </a> </li> <li class=md-nav__item> <a href=../Calibration/ class=md-nav__link> <span class=md-ellipsis> Calibration </span> </a> </li> <li class=md-nav__item> <a href=../Methods/ class=md-nav__link> <span class=md-ellipsis> Methods </span> </a> </li> <li class=md-nav__item> <a href=../Alerts/ class=md-nav__link> <span class=md-ellipsis> Alerts </span> </a> </li> <li class=md-nav__item> <a href=../Notes/ class=md-nav__link> <span class=md-ellipsis> Notes </span> </a> </li> <li class=md-nav__item> <a href=../Camera/ class=md-nav__link> <span class=md-ellipsis> Camera </span> </a> </li> <li class=md-nav__item> <a href=../Energy-Usage/ class=md-nav__link> <span class=md-ellipsis> Energy Usage </span> </a> </li> <li class=md-nav__item> <a href=../Python-Code/ class=md-nav__link> <span class=md-ellipsis> Python Code </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_4> <label class=md-nav__link for=__nav_4 id=__nav_4_label tabindex=0> <span class=md-ellipsis> Supported Devices </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_4_label aria-expanded=false> <label class=md-nav__title for=__nav_4> <span class="md-nav__icon md-icon"></span> Supported Devices </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../Supported-Inputs-By-Measurement/ class=md-nav__link> <span class=md-ellipsis> Inputs Sorted by Measurement </span> </a> </li> <li class=md-nav__item> <a href=../Supported-Inputs/ class=md-nav__link> <span class=md-ellipsis> Supported Inputs </span> </a> </li> <li class=md-nav__item> <a href=../Supported-Outputs/ class=md-nav__link> <span class=md-ellipsis> Supported Outputs </span> </a> </li> <li class=md-nav__item> <a href=../Supported-Functions/ class=md-nav__link> <span class=md-ellipsis> Supported Functions </span> </a> </li> <li class=md-nav__item> <a href=../Supported-Actions/ class=md-nav__link> <span class=md-ellipsis> Supported Actions </span> </a> </li> <li class=md-nav__item> <a href=../Supported-Widgets/ class=md-nav__link> <span class=md-ellipsis> Supported Widgets </span> </a> </li> <li class=md-nav__item> <a href=../I2C-Multiplexers/ class=md-nav__link> <span class=md-ellipsis> I2C Multiplexers </span> </a> </li> <li class=md-nav__item> <a href=../Analog-To-Digital-Converters/ class=md-nav__link> <span class=md-ellipsis> Analog-To-Digital Converters </span> </a> </li> <li class=md-nav__item> <a href=../Interfaces/ class=md-nav__link> <span class=md-ellipsis> Interfaces </span> </a> </li> <li class=md-nav__item> <a href=../Dependencies/ class=md-nav__link> <span class=md-ellipsis> Dependencies </span> </a> </li> <li class=md-nav__item> <a href=../Device-Notes/ class=md-nav__link> <span class=md-ellipsis> Device Notes </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_5> <label class=md-nav__link for=__nav_5 id=__nav_5_label tabindex=0> <span class=md-ellipsis> System </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_5_label aria-expanded=false> <label class=md-nav__title for=__nav_5> <span class="md-nav__icon md-icon"></span> System </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../System-Information/ class=md-nav__link> <span class=md-ellipsis> System Information </span> </a> </li> <li class=md-nav__item> <a href=../Configuration-Settings/ class=md-nav__link> <span class=md-ellipsis> System Configuration </span> </a> </li> <li class=md-nav__item> <a href=../Upgrade-Backup-Restore/ class=md-nav__link> <span class=md-ellipsis> Upgrade/Backup/Restore </span> </a> </li> <li class=md-nav__item> <a href=../Export-Import/ class=md-nav__link> <span class=md-ellipsis> Export/Import </span> </a> </li> <li class=md-nav__item> <a href=../Error-Codes/ class=md-nav__link> <span class=md-ellipsis> Error Codes </span> </a> </li> <li class=md-nav__item> <a href=../Mycodo-Client/ class=md-nav__link> <span class=md-ellipsis> Mycodo Client </span> </a> </li> <li class=md-nav__item> <a href=../API/ class=md-nav__link> <span class=md-ellipsis> API </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../Troubleshooting/ class=md-nav__link> <span class=md-ellipsis> Troubleshooting </span> </a> </li> </ul> </nav> </div> </div> </div> <div class="md-sidebar md-sidebar--secondary" data-md-component=sidebar data-md-type=toc> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#custom-functions class=md-nav__link> <span class=md-ellipsis> Custom Functions </span> </a> </li> <li class=md-nav__item> <a href=#pid-controller class=md-nav__link> <span class=md-ellipsis> PID Controller </span> </a> <nav class=md-nav aria-label="PID Controller"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#pid-controller-options class=md-nav__link> <span class=md-ellipsis> PID Controller Options </span> </a> </li> <li class=md-nav__item> <a href=#pid-output-calculation class=md-nav__link> <span class=md-ellipsis> PID Output Calculation </span> </a> </li> <li class=md-nav__item> <a href=#pid-tuning class=md-nav__link> <span class=md-ellipsis> PID Tuning </span> </a> <nav class=md-nav aria-label="PID Tuning"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#pid-tuning-resources class=md-nav__link> <span class=md-ellipsis> PID Tuning Resources </span> </a> </li> <li class=md-nav__item> <a href=#pid-control-theory class=md-nav__link> <span class=md-ellipsis> PID Control Theory </span> </a> </li> <li class=md-nav__item> <a href=#quick-setup-examples class=md-nav__link> <span class=md-ellipsis> Quick Setup Examples </span> </a> </li> <li class=md-nav__item> <a href=#exact-temperature-regulation class=md-nav__link> <span class=md-ellipsis> Exact Temperature Regulation </span> </a> </li> <li class=md-nav__item> <a href=#high-temperature-regulation class=md-nav__link> <span class=md-ellipsis> High Temperature Regulation </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#pid-autotune class=md-nav__link> <span class=md-ellipsis> PID Autotune </span> </a> </li> <li class=md-nav__item> <a href=#conditional class=md-nav__link> <span class=md-ellipsis> Conditional </span> </a> <nav class=md-nav aria-label=Conditional> <ul class=md-nav__list> <li class=md-nav__item> <a href=#conditional-options class=md-nav__link> <span class=md-ellipsis> Conditional Options </span> </a> </li> <li class=md-nav__item> <a href=#conditional-setup-guide class=md-nav__link> <span class=md-ellipsis> Conditional Setup Guide </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#trigger class=md-nav__link> <span class=md-ellipsis> Trigger </span> </a> <nav class=md-nav aria-label=Trigger> <ul class=md-nav__list> <li class=md-nav__item> <a href=#output-onoff-options class=md-nav__link> <span class=md-ellipsis> Output (On/Off) Options </span> </a> </li> <li class=md-nav__item> <a href=#output-pwm-options class=md-nav__link> <span class=md-ellipsis> Output (PWM) Options </span> </a> </li> <li class=md-nav__item> <a href=#edge-options class=md-nav__link> <span class=md-ellipsis> Edge Options </span> </a> </li> <li class=md-nav__item> <a href=#run-pwm-method-options class=md-nav__link> <span class=md-ellipsis> Run PWM Method Options </span> </a> </li> <li class=md-nav__item> <a href=#sunrisesunset-options class=md-nav__link> <span class=md-ellipsis> Sunrise/Sunset Options </span> </a> </li> <li class=md-nav__item> <a href=#timer-duration-options class=md-nav__link> <span class=md-ellipsis> Timer (Duration) Options </span> </a> </li> <li class=md-nav__item> <a href=#timer-daily-time-point-options class=md-nav__link> <span class=md-ellipsis> Timer (Daily Time Point) Options </span> </a> </li> <li class=md-nav__item> <a href=#timer-daily-time-span-options class=md-nav__link> <span class=md-ellipsis> Timer (Daily Time Span) Options </span> </a> </li> </ul> </nav> </li> </ul> </nav> </div> </div> </div> <div class=md-content data-md-component=content> <article class="md-content__inner md-typeset"> <h1>Functions</h1> <ul> <li class="i18n-link i18n-link-not-found i18n-link-de">Deutsche: Deze pagina is niet vertaald naar het Duits.</li> <li class="i18n-link i18n-link-not-found i18n-link-es">Español: Esta página no está traducida al castellano.</li> <li class="i18n-link i18n-link-not-found i18n-link-fr">Français: Cette page n'est pas traduite en français.</li> <li class="i18n-link i18n-link-not-found i18n-link-id">Bahasa Indonesia: Halaman ini tidak diterjemahkan ke bahasa Indonesia.</li> <li class="i18n-link i18n-link-not-found i18n-link-it">Italiano: Questa pagina non è tradotta in italiano.</li> <li class="i18n-link i18n-link-not-found i18n-link-nn">Norsk: Denne siden er ikke oversatt til norsk.</li> <li class="i18n-link i18n-link-not-found i18n-link-pl">Polski: Ta strona nie jest przetłumaczona na język polski.</li> <li class="i18n-link i18n-link-not-found i18n-link-pt">Português: Esta página não está traduzida para o português.</li> <li class="i18n-link i18n-link-not-found i18n-link-ru">русский язык: Эта страница не переведена на русский язык.</li> <li class="i18n-link i18n-link-not-found i18n-link-sr">српски: Ова страница није преведена на српски.</li> <li class="i18n-link i18n-link-not-found i18n-link-sv">Svenska: Denna sida är inte översatt till svenska.</li> <li class="i18n-link i18n-link-not-found i18n-link-tr">Türkçe: Bu sayfa Türkçe'ye çevrilmemiştir.</li> <li class="i18n-link i18n-link-not-found i18n-link-zh">中文: 此页面未翻译成中文.</li> </ul> <p>Page: <code>Setup -&gt; Function</code></p> <p>For a full list of supported Functions, see <a href=../Supported-Functions/ >Supported Functions</a>.</p> <p>Function controllers perform tasks that often involve the use of Inputs and Outputs.</p> <div class="admonition note"> <p class=admonition-title>Note</p> <p>"Last" means the Function will only acquire the last (latest) measurement in the database. "Past" means the Function will acquire all measurements from the present until the "Max Age (seconds)" that's been set (e.g. if measurements are acquired every 10 seconds, and a Max Age is set to 60 seconds, there will on average be 6 measurements returned to the Function to operate with).</p> </div> <h2 id=custom-functions>Custom Functions<a class=headerlink href=#custom-functions title="Permanent link">~</a></h2> <p>There is a Custom Function import system in Mycodo that allows user-created Functions to be used in the Mycodo system. Custom Functions can be uploaded on the <code>[Gear Icon] -&gt; Configure -&gt; Custom Functions</code> page. After import, they will be available to use on the <code>Setup -&gt; Function</code> page.</p> <p>If you develop a working Function module, please consider <a href="https://github.com/kizniche/Mycodo/issues/new?assignees=&labels=&template=feature-request.md&title=New%20Module">creating a new GitHub issue</a> or pull request, and it may be included in the built-in set.</p> <p>Open any of the built-in modules located in the directory <a href=https://github.com/kizniche/Mycodo/tree/master/mycodo/functions/ >Mycodo/mycodo/functions</a> for examples of the proper formatting.</p> <p>There are also example Custom Functions in the directory <a href=https://github.com/kizniche/Mycodo/tree/master/mycodo/functions/examples>Mycodo/mycodo/functions/examples</a></p> <p>Additionally, I have another github repository devoted to Custom Modules that are not included in the built-in set, at <a href=https://github.com/kizniche/Mycodo-custom>kizniche/Mycodo-custom</a>.</p> <p>For Functions that require new measurements/units, they can be added on the <code>[Gear Icon] -&gt; Configure -&gt; Measurements</code> page.</p> <h2 id=pid-controller>PID Controller<a class=headerlink href=#pid-controller title="Permanent link">~</a></h2> <p>A <a href=https://en.wikipedia.org/wiki/PID_controller>proportional-derivative-integral (PID) controller</a> is a control loop feedback mechanism used throughout industry for controlling systems. It efficiently brings a measurable condition, such as the temperature, to a desired state and maintains it there with little overshoot and oscillation. A well-tuned PID controller will raise to the setpoint quickly, have minimal overshoot, and maintain the setpoint with little oscillation.</p> <p>PID settings may be changed while the PID is activated and the new settings will take effect immediately. If settings are changed while the controller is paused, the values will be used once the controller resumes operation.</p> <h3 id=pid-controller-options>PID Controller Options<a class=headerlink href=#pid-controller-options title="Permanent link">~</a></h3> <table> <thead> <tr class=header> <th>Setting</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td>Activate/Deactivate</td> <td>Turn a particular PID controller on or off.</td> </tr> <tr> <td>Pause</td> <td>When paused, the control variable will not be updated and the PID will not turn on the associated outputs. Settings can be changed without losing current PID output values.</td> </tr> <tr> <td>Hold</td> <td>When held, the control variable will not be updated but the PID will turn on the associated outputs, Settings can be changed without losing current PID output values.</td> </tr> <tr> <td>Resume</td> <td>Resume a PID controller from being held or paused.</td> </tr> <tr> <td>Direction</td> <td>This is the direction that you wish to regulate. For example, if you only require the temperature to be raised, set this to &quot;Up,&quot; but if you require regulation up and down, set this to &quot;Both.&quot;</td> </tr> <tr> <td>Period</td> <td>This is the duration between when the PID acquires a measurement, the PID is updated, and the output is modulated.</td> </tr> <tr> <td>Start Offset (seconds)</td> <td>Wait this duration before attempting the first calculation/measurement.</td> </tr> <tr> <td>Max Age</td> <td>The time (in seconds) that the sensor measurement age is required to be less than. If the measurement is not younger than this age, the measurement is thrown out and the PID will not actuate the output. This is a safety measure to ensure the PID is only using recent measurements.</td> </tr> <tr> <td>Setpoint</td> <td>This is the specific point you would like the environment to be regulated at. For example, if you would like the humidity regulated to 60%, enter 60.</td> </tr> <tr> <td>Band (+/- Setpoint)</td> <td>Hysteresis option. If set to a non-0 value, the setpoint will become a band, which will be between the band_max=setpoint+band and band_min=setpoint-band. If Raising, the PID will raise above band_max, then wait until the condition falls below band_min to resume regulation. If Lowering, the PID will lower below band_min, then wait until the condition rises above band_max to resume regulating. If set to Both, regulation will only occur to the outside min and max of the band, and cease when within the band. Set to 0 to disable Hysteresis.</td> </tr> <tr> <td>Store Lower as Negative</td> <td>Checking this will store all output variables (PID and output duration/duty cycle) as a negative values in the measurement database. This is useful for displaying graphs that indicate whether the PID is currently lowering or raising. Disable this if you desire all positive values to be stored in the measurement database.</td> </tr> <tr> <td>K<sub>P</sub> Gain</td> <td>Proportional coefficient (non-negative). Accounts for present values of the error. For example, if the error is large and positive, the control output will also be large and positive.</td> </tr> <tr> <td>K<sub>I</sub> Gain</td> <td>Integral coefficient (non-negative). Accounts for past values of the error. For example, if the current output is not sufficiently strong, the integral of the error will accumulate over time, and the controller will respond by applying a stronger action.</td> </tr> <tr> <td>K<sub>D</sub> Gain</td> <td>Derivative coefficient (non-negative). Accounts for predicted future values of the error, based on its current rate of change.</td> </tr> <tr> <td>Integrator Min</td> <td>The minimum allowed integrator value, for calculating Ki_total: (Ki_total = Ki * integrator; and PID output = Kp_total + Ki_total + Kd_total)</td> </tr> <tr> <td>Integrator Max</td> <td>The maximum allowed integrator value, for calculating Ki_total: (Ki_total = Ki * integrator; and PID output = Kp_total + Ki_total + Kd_total)</td> </tr> <tr> <td>Output (Raise/Lower)</td> <td>This is the output that will cause the particular environmental condition to rise or lower. In the case of raising the temperature, this may be a heating pad or coil.</td> </tr> <tr> <td>Min On Duration, Duty Cycle, or Amount (Raise/Lower)</td> <td>This is the minimum value that the PID output must be before Output (Lower) turns on. If the PID output is less than this value, Duration Outputs will not turn on, and PWM Outputs will be turned off unless Always Min is enabled.</td> </tr> <tr> <td>Max On Duration, Duty Cycle, or Amount (Raise/Lower)</td> <td>This is the maximum duration, volume, or duty cycle the Output (Raise) can be set to. If the PID output is greater than this value, the Max value set here will be used.</td> </tr> <tr> <td>Min Off Duration (Raise/Lower)</td> <td>For On/Off (Duration) Outputs, this is the minimum amount of time the Output must have been off for before it is allowed to turn back on. Ths is useful for devices that can be damaged by rapid power cycling (e.g. fridges).</td> </tr> <tr> <td>Always Min (Raise/Lower)</td> <td>For PWM Outputs only. If enabled, the duty cycle will never be set below the Min value.</td> </tr> <tr> <td>Setpoint Tracking Method</td> <td>Set a method to change the setpoint over time.</td> </tr> </tbody> </table> <h3 id=pid-output-calculation>PID Output Calculation<a class=headerlink href=#pid-output-calculation title="Permanent link">~</a></h3> <p>PID Controllers can control a number of different output types (e.g. duration, volume, or PWM duty cycle). For most output types, the PID output (Control Variable) will be proportional (i.e. <code>Output Duration = PID Control Variable</code>). However, when outputting a duty cycle, it will be calculated as <code>Duty Cycle = (Control Variable / Period) * 100</code>.</p> <div class="admonition note"> <p class=admonition-title>Note</p> <p>Control Variable = P Output + I Output + D Output. Duty cycle is limited within the 0 - 100 % range and the set Min Duty Cycle and Max Duty Cycle. An output duration is limited by the set Min On Duration and Max On Duration, and output volume similarly.</p> </div> <h3 id=pid-tuning>PID Tuning<a class=headerlink href=#pid-tuning title="Permanent link">~</a></h3> <p>PID tuning can be a complex process, depending on the output device(s) used and the environment or system under control. A system with large perturbations will be more difficult to control than one that is stable. Similarly, output devices that are unsuitable may make PID tuning difficult or impossible. Learning how PID controllers operate and the theory behind their tuning will not only better prepare you to operate a PID controller, but also in the development of your system and selection and implementation of the output devices used to regulate your system. </p> <h4 id=pid-tuning-resources>PID Tuning Resources<a class=headerlink href=#pid-tuning-resources title="Permanent link">~</a></h4> <ul> <li><a href=https://hackaday.io/project/11997-mycodo-environmental-regulation-system/log/45733-sous-vide-pid-tuning-and-the-unexpected-electrical-fire>Sous Vide PID Tuning and the Unexpected Electrical Fire</a></li> </ul> <h4 id=pid-control-theory>PID Control Theory<a class=headerlink href=#pid-control-theory title="Permanent link">~</a></h4> <p>The PID controller is the most common regulatory controller found in industrial settings, for it"s ability to handle both simple and complex regulation. The PID controller has three paths, the proportional, integral, and derivative.</p> <p>The <strong>P</strong>roportional takes the error and multiplies it by the constant K<sub>P</sub>, to yield an output value. When the error is large, there will be a large proportional output.</p> <p>The <strong>I</strong>ntegral takes the error and multiplies it by K<sub>I</sub>, then integrates it (K<sub>I</sub> · 1/s). As the error changes over time, the integral will continually sum it and multiply it by the constant K<sub>I</sub>. The integral is used to remove perpetual error in the control system. If using K<sub>P</sub> alone produces an output that produces a perpetual error (i.e. if the sensor measurement never reaches the Set Point), the integral will increase the output until the error decreases and the Set Point is reached.</p> <p>The <strong>D</strong>erivative multiplies the error by K<sub>D</sub>, then differentiates it (K<sub>D</sub> · s). When the error rate changes over time, the output signal will change. The faster the change in error, the larger the derivative path becomes, decreasing the output rate of change. This has the effect of dampening overshoot and undershoot (oscillation) of the Set Point.</p> <p><img alt="PID Animation" src=../images/PID-Animation.gif></p> <p>The K<sub>P</sub>, K<sub>I</sub>, and K<sub>D</sub> gains determine how much each of the P, I, and D variables influence the final PID output value. For instance, the greater the value of the gain, the more influence that variable has on the output.</p> <p><img alt="PID Equation" src=../images/PID-Equation.jpg></p> <p>The output from the PID controller can be used in a number of ways. A simple use is to use this value as the number of seconds an output is turned on during a periodic interval (Period). For instance, if the Period is set to 30 seconds, the PID equation has the desired measurement and the actual measurement used to calculate the PID output every 30 seconds. The more the output is on during this period, the more it will affect the system. For example, an output on for 15 seconds every 30 seconds is at a 50 % duty cycle, and would affect the system roughly half as much as when the output is on for 30 seconds every 30 seconds, or at at 100 % duty cycle. The PID controller will calculate the output based on the amount of error (how far the actual measurement is from the desired measurement). If the error increases or persists, the output increases, causing the output to turn on for a longer duration within the Period, which usually in term causes the measured condition to change and the error to reduce. When the error reduces, the control variable decreases, meaning the output is turned on for a shorter duration of time. The ultimate goal of a well-tuned PID controller is to bring the actual measurement to the desired measurement quickly, with little overshoot, and maintain the setpoint with minimal oscillation.</p> <hr> <p>Using temperature as an example, the Process Variable (PV) is the measured temperature, the Setpoint (SP) is the desired temperature, and the Error (e) is the distance between the measured temperature and the desired temperature (indicating if the actual temperature is too hot or too cold and to what degree). The error is manipulated by each of the three PID components, producing an output, called the Manipulated Variable (MV) or Control Variable (CV). To allow control of how much each path contributes to the output value, each path is multiplied by a gain (represented by K<sub>P</sub>, K<sub>I</sub>, and K<sub>D</sub>). By adjusting the gains, the sensitivity of the system to each path is affected. When all three paths are summed, the PID output is produced. If a gain is set to 0, that path does not contribute to the output and that path is essentially turned off.</p> <p>The output can be used a number of ways, however this controller was designed to use the output to affect the measured value (PV). This feedback loop, with a <em>properly tuned</em> PID controller, can achieve a set point in a short period of time, maintain regulation with little oscillation, and respond quickly to disturbance.</p> <p>Therefor, if one would be regulating temperature, the sensor would be a temperature sensor and the feedback device(s) would be able to heat and cool. If the temperature is lower than the Set Point, the output value would be positive and a heater would activate. The temperature would rise toward the desired temperature, causing the error to decrease and a lower output to be produced. This feedback loop would continue until the error reaches 0 (at which point the output would be 0). If the temperature continues to rise past the Set Point (this is may be acceptable, depending on the degree), the PID would produce a negative output, which could be used by the cooling device to bring the temperature back down, to reduce the error. If the temperature would normally lower without the aid of a cooling device, then the system can be simplified by omitting a cooler and allowing it to lower on its own.</p> <p>Implementing a controller that effectively utilizes K<sub>P</sub>, K<sub>I</sub>, and K<sub>D</sub> can be challenging. Furthermore, it is often unnecessary. For instance, the K<sub>I</sub> and K<sub>D</sub> can be set to 0, effectively turning them off and producing the very popular and simple P controller. Also popular is the PI controller. It is recommended to start with only K<sub>P</sub> activated, then experiment with K<sub>P</sub> and K<sub>I</sub>, before finally using all three. Because systems will vary (e.g. airspace volume, degree of insulation, and the degree of impact from the connected device, etc.), each path will need to be adjusted through experimentation to produce an effective output.</p> <h4 id=quick-setup-examples>Quick Setup Examples<a class=headerlink href=#quick-setup-examples title="Permanent link">~</a></h4> <p>These example setups are meant to illustrate how to configure regulation in particular directions, and not to achieve ideal values to configure your K<sub>P</sub>, K<sub>I</sub>, and K<sub>D</sub> gains. There are a number of online resources that discuss techniques and methods that have been developed to determine ideal PID values (such as <a href=http://robotics.stackexchange.com/questions/167/what-are-good-strategies-for-tuning-pid-loops>here</a>, <a href=http://innovativecontrols.com/blog/basics-tuning-pid-loops>here</a>, <a href=https://hennulat.wordpress.com/2011/01/12/pid-loop-tuning-101/ >here</a>, <a href=http://eas.uccs.edu/wang/ECE4330F12/PID-without-a-PhD.pdf>here</a>, and <a href=http://www.atmel.com/Images/doc2558.pdf>here</a>) and since there are no universal values that will work for every system, it is recommended to conduct your own research to understand the variables and essential to conduct your own experiments to effectively implement them.</p> <p>Provided merely as an example of the variance of PID values, one of my setups had temperature PID values (up regulation) of K<sub>P</sub> = 30, K<sub>I</sub> = 1.0, and K<sub>D</sub> = 0.5, and humidity PID values (up regulation) of K<sub>P</sub> = 1.0, K<sub>I</sub> = 0.2, and K<sub>D</sub> = 0.5. Furthermore, these values may not have been optimal but they worked well for the conditions of my environmental chamber.</p> <h4 id=exact-temperature-regulation>Exact Temperature Regulation<a class=headerlink href=#exact-temperature-regulation title="Permanent link">~</a></h4> <p>This will set up the system to raise and lower the temperature to a certain level with two regulatory devices (one that heats and one that cools).</p> <p>Add a sensor, then save the proper device and pin/address for each sensor and activate the sensor.</p> <p>Add two outputs, then save each GPIO and On Trigger state.</p> <p>Add a PID, then select the newly-created sensor. Change <em>Setpoint</em> to the desired temperature, <em>Regulate Direction</em> to "Both". Set <em>Raise Output</em> to the relay attached to the heating device and the <em>Lower Relay</em> to the relay attached to the cooling device.</p> <p>Set K<sub>P</sub> = 1, K<sub>I</sub> = 0, and K<sub>D</sub> = 0, then activate the PID.</p> <p>If the temperature is lower than the Set Point, the heater should activate at some interval determined by the PID controller until the temperature rises to the set point. If the temperature goes higher than the Set Point (or Set Point + Buffer), the cooling device will activate until the temperature returns to the set point. If the temperature is not reaching the Set Point after a reasonable amount of time, increase the K<sub>P</sub> value and see how that affects the system. Experiment with different configurations involving only <em>Read Interval</em> and K<sub>P</sub> to achieve a good regulation. Avoid changing the K<sub>I</sub> and K<sub>D</sub> from 0 until a working regulation is achieved with K<sub>P</sub> alone.</p> <p>View graphs in the 6 to 12 hour time span to identify how well the temperature is regulated to the Setpoint. What is meant by well-regulated will vary, depending on your specific application and tolerances. Most applications of a PID controller would like to see the proper temperature attained within a reasonable amount of time and with little oscillation around the Setpoint.</p> <p>Once regulation is achieved, experiment by reducing K<sub>P</sub> slightly (~25%) and increasing K<sub>I</sub> by a low amount to start, such as 0.1 (or lower, 0.01), then start the PID and observe how well the controller regulates. Slowly increase K<sub>I</sub> until regulation becomes both quick and with little oscillation. At this point, you should be fairly familiar with experimenting with the system and the K<sub>D</sub> value can be experimented with once both K<sub>P</sub> and K<sub>I</sub> have been tuned.</p> <h4 id=high-temperature-regulation>High Temperature Regulation<a class=headerlink href=#high-temperature-regulation title="Permanent link">~</a></h4> <p>Often the system can be simplified if two-way regulation is not needed. For instance, if cooling is unnecessary, this can be removed from the system and only up-regulation can be used.</p> <p>Use the same configuration as the <a href=./#exact-temperature-regulation>Exact Temperature Regulation</a> example, except change <em>Regulate Direction</em> to "Raise" and do not touch the "Down Relay" section.</p> <h2 id=pid-autotune>PID Autotune<a class=headerlink href=#pid-autotune title="Permanent link">~</a></h2> <div class="admonition warning"> <p class=admonition-title>Warning</p> <p>This is an experimental feature. It is best not used until you are familiar with the theory, operation, and tuning of a PID.</p> </div> <p>The Autotune function is a standalone controller that is useful for determining appropriate Kp, Ki, and Kd gains for use in the a PID controller. The autotuner will manipulate an output and analyze the measured response in a particular environment/system. It will take several cycles of perturbing the system with the chosen output before enough data is available to calculate the PID gains. In order to use this feature, select a Measurement and an Output that can module the specific condition being measured. Then, configure the Noise Band and Outstep and activate the function. Log lines of the autotuner will appear in the daemon log (<code>[Gear Icon] -&gt; Mycodo Logs -&gt; Daemon Log</code>). While the autotune is being performed, it is recommended to create a dashboard graph that includes the Measurement and Output in order to see what the PID Autotuner is doing and to notice any potential issues with the autotune settings that have been configured. If the autotune is taking a long time to complete, there may not be enough stability in the system being manipulated to calculate a reliable set of PID gains. This may be because there are too many perturbations to the system, or conditions are changing too rapidly to acquire consistent measurement oscillations. If this is the case, try modifying your system to increase stability and yield consistent measurement oscillations. Once the autotune successfully completes, perturbations may be reintroduced in order to further tune the PID controller to handle them.</p> <table> <thead> <tr class=header> <th>Setting</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td>Measurement</td> <td>This is the Input or Function measurement that is measuring the specific condition that the Output will affect. For instance, this could be a temperature measurement and the output could be a heater.</td> </tr> <tr> <td>Output</td> <td>This is the Output that will affect the measurement when it's activated. The autotune function will periodically turn this output on in order to raise the measurement beyond the setpoint.</td> </tr> <tr> <td>Period</td> <td>This is the period of time between the Output being turned on. This should be set to the same Period you wish to use for your PID controller. A different Period can significantly affect the PID gains that the autotune produces.</td> </tr> <tr> <td>Setpoint</td> <td>This is the desired measurement condition value. For instance, if temperature is being measured, this should be set a several degrees higher than the current temperature so the output, when activated, will cause the temperature to rise beyond the setpoint.</td> </tr> <tr> <td>Noise Band</td> <td>This is the amount above the setpoint the measured condition must reach before the output turns off. This is also how much below the setpoint the measured condition must fall before the output turns back on.</td> </tr> <tr> <td>Outstep</td> <td>This is how many seconds the output will turn on every PID Period. For instance, to autotune with 50% power, ensure the Outstep is half the value of the PID Period.</td> </tr> <tr> <td>Direction</td> <td>This is the direction for which the Output will push the Measurement. For instance, a heater will raise temperature, whereas a cooler will lower temperature.</td> </tr> </tbody> </table> <p>Typical graph output will look like this:</p> <p><img alt="PID Autotune Output" src=../images/Autotune-Output-Example.png></p> <p>And typical Daemon Log output will look like this:</p> <div class="language-console highlight"><pre><span></span><code><span id=__span-0-1><a id=__codelineno-0-1 name=__codelineno-0-1 href=#__codelineno-0-1></a><span class=go>2018-08-04 23:32:20,876 - mycodo.pid_3b533dff - INFO - Activated in 187.2 ms</span>
</span><span id=__span-0-2><a id=__codelineno-0-2 name=__codelineno-0-2 href=#__codelineno-0-2></a><span class=go>2018-08-04 23:32:20,877 - mycodo.pid_autotune - INFO - PID Autotune started</span>
</span><span id=__span-0-3><a id=__codelineno-0-3 name=__codelineno-0-3 href=#__codelineno-0-3></a><span class=go>2018-08-04 23:33:50,823 - mycodo.pid_autotune - INFO -</span>
</span><span id=__span-0-4><a id=__codelineno-0-4 name=__codelineno-0-4 href=#__codelineno-0-4></a><span class=go>2018-08-04 23:33:50,830 - mycodo.pid_autotune - INFO - Cycle: 19</span>
</span><span id=__span-0-5><a id=__codelineno-0-5 name=__codelineno-0-5 href=#__codelineno-0-5></a><span class=go>2018-08-04 23:33:50,831 - mycodo.pid_autotune - INFO - switched state: relay step down</span>
</span><span id=__span-0-6><a id=__codelineno-0-6 name=__codelineno-0-6 href=#__codelineno-0-6></a><span class=go>2018-08-04 23:33:50,832 - mycodo.pid_autotune - INFO - input: 32.52</span>
</span><span id=__span-0-7><a id=__codelineno-0-7 name=__codelineno-0-7 href=#__codelineno-0-7></a><span class=go>2018-08-04 23:36:00,854 - mycodo.pid_autotune - INFO -</span>
</span><span id=__span-0-8><a id=__codelineno-0-8 name=__codelineno-0-8 href=#__codelineno-0-8></a><span class=go>2018-08-04 23:36:00,860 - mycodo.pid_autotune - INFO - Cycle: 45</span>
</span><span id=__span-0-9><a id=__codelineno-0-9 name=__codelineno-0-9 href=#__codelineno-0-9></a><span class=go>2018-08-04 23:36:00,862 - mycodo.pid_autotune - INFO - found peak: 34.03</span>
</span><span id=__span-0-10><a id=__codelineno-0-10 name=__codelineno-0-10 href=#__codelineno-0-10></a><span class=go>2018-08-04 23:36:00,863 - mycodo.pid_autotune - INFO - peak count: 1</span>
</span><span id=__span-0-11><a id=__codelineno-0-11 name=__codelineno-0-11 href=#__codelineno-0-11></a><span class=go>2018-08-04 23:37:20,802 - mycodo.pid_autotune - INFO -</span>
</span><span id=__span-0-12><a id=__codelineno-0-12 name=__codelineno-0-12 href=#__codelineno-0-12></a><span class=go>2018-08-04 23:37:20,809 - mycodo.pid_autotune - INFO - Cycle: 61</span>
</span><span id=__span-0-13><a id=__codelineno-0-13 name=__codelineno-0-13 href=#__codelineno-0-13></a><span class=go>2018-08-04 23:37:20,810 - mycodo.pid_autotune - INFO - switched state: relay step up</span>
</span><span id=__span-0-14><a id=__codelineno-0-14 name=__codelineno-0-14 href=#__codelineno-0-14></a><span class=go>2018-08-04 23:37:20,811 - mycodo.pid_autotune - INFO - input: 31.28</span>
</span><span id=__span-0-15><a id=__codelineno-0-15 name=__codelineno-0-15 href=#__codelineno-0-15></a><span class=go>2018-08-04 23:38:30,867 - mycodo.pid_autotune - INFO -</span>
</span><span id=__span-0-16><a id=__codelineno-0-16 name=__codelineno-0-16 href=#__codelineno-0-16></a><span class=go>2018-08-04 23:38:30,874 - mycodo.pid_autotune - INFO - Cycle: 75</span>
</span><span id=__span-0-17><a id=__codelineno-0-17 name=__codelineno-0-17 href=#__codelineno-0-17></a><span class=go>2018-08-04 23:38:30,876 - mycodo.pid_autotune - INFO - found peak: 32.17</span>
</span><span id=__span-0-18><a id=__codelineno-0-18 name=__codelineno-0-18 href=#__codelineno-0-18></a><span class=go>2018-08-04 23:38:30,878 - mycodo.pid_autotune - INFO - peak count: 2</span>
</span><span id=__span-0-19><a id=__codelineno-0-19 name=__codelineno-0-19 href=#__codelineno-0-19></a><span class=go>2018-08-04 23:38:40,852 - mycodo.pid_autotune - INFO -</span>
</span><span id=__span-0-20><a id=__codelineno-0-20 name=__codelineno-0-20 href=#__codelineno-0-20></a><span class=go>2018-08-04 23:38:40,858 - mycodo.pid_autotune - INFO - Cycle: 77</span>
</span><span id=__span-0-21><a id=__codelineno-0-21 name=__codelineno-0-21 href=#__codelineno-0-21></a><span class=go>2018-08-04 23:38:40,860 - mycodo.pid_autotune - INFO - switched state: relay step down</span>
</span><span id=__span-0-22><a id=__codelineno-0-22 name=__codelineno-0-22 href=#__codelineno-0-22></a><span class=go>2018-08-04 23:38:40,861 - mycodo.pid_autotune - INFO - input: 32.85</span>
</span><span id=__span-0-23><a id=__codelineno-0-23 name=__codelineno-0-23 href=#__codelineno-0-23></a><span class=go>2018-08-04 23:40:50,834 - mycodo.pid_autotune - INFO -</span>
</span><span id=__span-0-24><a id=__codelineno-0-24 name=__codelineno-0-24 href=#__codelineno-0-24></a><span class=go>2018-08-04 23:40:50,835 - mycodo.pid_autotune - INFO - Cycle: 103</span>
</span><span id=__span-0-25><a id=__codelineno-0-25 name=__codelineno-0-25 href=#__codelineno-0-25></a><span class=go>2018-08-04 23:40:50,836 - mycodo.pid_autotune - INFO - found peak: 33.93</span>
</span><span id=__span-0-26><a id=__codelineno-0-26 name=__codelineno-0-26 href=#__codelineno-0-26></a><span class=go>2018-08-04 23:40:50,836 - mycodo.pid_autotune - INFO - peak count: 3</span>
</span><span id=__span-0-27><a id=__codelineno-0-27 name=__codelineno-0-27 href=#__codelineno-0-27></a><span class=go>2018-08-04 23:42:05,799 - mycodo.pid_autotune - INFO -</span>
</span><span id=__span-0-28><a id=__codelineno-0-28 name=__codelineno-0-28 href=#__codelineno-0-28></a><span class=go>2018-08-04 23:42:05,805 - mycodo.pid_autotune - INFO - Cycle: 118</span>
</span><span id=__span-0-29><a id=__codelineno-0-29 name=__codelineno-0-29 href=#__codelineno-0-29></a><span class=go>2018-08-04 23:42:05,806 - mycodo.pid_autotune - INFO - switched state: relay step up</span>
</span><span id=__span-0-30><a id=__codelineno-0-30 name=__codelineno-0-30 href=#__codelineno-0-30></a><span class=go>2018-08-04 23:42:05,807 - mycodo.pid_autotune - INFO - input: 31.27</span>
</span><span id=__span-0-31><a id=__codelineno-0-31 name=__codelineno-0-31 href=#__codelineno-0-31></a><span class=go>2018-08-04 23:43:15,816 - mycodo.pid_autotune - INFO -</span>
</span><span id=__span-0-32><a id=__codelineno-0-32 name=__codelineno-0-32 href=#__codelineno-0-32></a><span class=go>2018-08-04 23:43:15,822 - mycodo.pid_autotune - INFO - Cycle: 132</span>
</span><span id=__span-0-33><a id=__codelineno-0-33 name=__codelineno-0-33 href=#__codelineno-0-33></a><span class=go>2018-08-04 23:43:15,824 - mycodo.pid_autotune - INFO - found peak: 32.09</span>
</span><span id=__span-0-34><a id=__codelineno-0-34 name=__codelineno-0-34 href=#__codelineno-0-34></a><span class=go>2018-08-04 23:43:15,825 - mycodo.pid_autotune - INFO - peak count: 4</span>
</span><span id=__span-0-35><a id=__codelineno-0-35 name=__codelineno-0-35 href=#__codelineno-0-35></a><span class=go>2018-08-04 23:43:25,790 - mycodo.pid_autotune - INFO -</span>
</span><span id=__span-0-36><a id=__codelineno-0-36 name=__codelineno-0-36 href=#__codelineno-0-36></a><span class=go>2018-08-04 23:43:25,796 - mycodo.pid_autotune - INFO - Cycle: 134</span>
</span><span id=__span-0-37><a id=__codelineno-0-37 name=__codelineno-0-37 href=#__codelineno-0-37></a><span class=go>2018-08-04 23:43:25,797 - mycodo.pid_autotune - INFO - switched state: relay step down</span>
</span><span id=__span-0-38><a id=__codelineno-0-38 name=__codelineno-0-38 href=#__codelineno-0-38></a><span class=go>2018-08-04 23:43:25,798 - mycodo.pid_autotune - INFO - input: 32.76</span>
</span><span id=__span-0-39><a id=__codelineno-0-39 name=__codelineno-0-39 href=#__codelineno-0-39></a><span class=go>2018-08-04 23:45:30,802 - mycodo.pid_autotune - INFO -</span>
</span><span id=__span-0-40><a id=__codelineno-0-40 name=__codelineno-0-40 href=#__codelineno-0-40></a><span class=go>2018-08-04 23:45:30,808 - mycodo.pid_autotune - INFO - Cycle: 159</span>
</span><span id=__span-0-41><a id=__codelineno-0-41 name=__codelineno-0-41 href=#__codelineno-0-41></a><span class=go>2018-08-04 23:45:30,810 - mycodo.pid_autotune - INFO - found peak: 33.98</span>
</span><span id=__span-0-42><a id=__codelineno-0-42 name=__codelineno-0-42 href=#__codelineno-0-42></a><span class=go>2018-08-04 23:45:30,811 - mycodo.pid_autotune - INFO - peak count: 5</span>
</span><span id=__span-0-43><a id=__codelineno-0-43 name=__codelineno-0-43 href=#__codelineno-0-43></a><span class=go>2018-08-04 23:45:30,812 - mycodo.pid_autotune - INFO -</span>
</span><span id=__span-0-44><a id=__codelineno-0-44 name=__codelineno-0-44 href=#__codelineno-0-44></a><span class=go>2018-08-04 23:45:30,814 - mycodo.pid_autotune - INFO - amplitude: 0.9099999999999989</span>
</span><span id=__span-0-45><a id=__codelineno-0-45 name=__codelineno-0-45 href=#__codelineno-0-45></a><span class=go>2018-08-04 23:45:30,815 - mycodo.pid_autotune - INFO - amplitude deviation: 0.06593406593406595</span>
</span><span id=__span-0-46><a id=__codelineno-0-46 name=__codelineno-0-46 href=#__codelineno-0-46></a><span class=go>2018-08-04 23:46:40,851 - mycodo.pid_autotune - INFO -</span>
</span><span id=__span-0-47><a id=__codelineno-0-47 name=__codelineno-0-47 href=#__codelineno-0-47></a><span class=go>2018-08-04 23:46:40,857 - mycodo.pid_autotune - INFO - Cycle: 173</span>
</span><span id=__span-0-48><a id=__codelineno-0-48 name=__codelineno-0-48 href=#__codelineno-0-48></a><span class=go>2018-08-04 23:46:40,858 - mycodo.pid_autotune - INFO - switched state: relay step up</span>
</span><span id=__span-0-49><a id=__codelineno-0-49 name=__codelineno-0-49 href=#__codelineno-0-49></a><span class=go>2018-08-04 23:46:40,859 - mycodo.pid_autotune - INFO - input: 31.37</span>
</span><span id=__span-0-50><a id=__codelineno-0-50 name=__codelineno-0-50 href=#__codelineno-0-50></a><span class=go>2018-08-04 23:47:55,860 - mycodo.pid_autotune - INFO -</span>
</span><span id=__span-0-51><a id=__codelineno-0-51 name=__codelineno-0-51 href=#__codelineno-0-51></a><span class=go>2018-08-04 23:47:55,866 - mycodo.pid_autotune - INFO - Cycle: 188</span>
</span><span id=__span-0-52><a id=__codelineno-0-52 name=__codelineno-0-52 href=#__codelineno-0-52></a><span class=go>2018-08-04 23:47:55,868 - mycodo.pid_autotune - INFO - found peak: 32.36</span>
</span><span id=__span-0-53><a id=__codelineno-0-53 name=__codelineno-0-53 href=#__codelineno-0-53></a><span class=go>2018-08-04 23:47:55,869 - mycodo.pid_autotune - INFO - peak count: 6</span>
</span><span id=__span-0-54><a id=__codelineno-0-54 name=__codelineno-0-54 href=#__codelineno-0-54></a><span class=go>2018-08-04 23:47:55,870 - mycodo.pid_autotune - INFO -</span>
</span><span id=__span-0-55><a id=__codelineno-0-55 name=__codelineno-0-55 href=#__codelineno-0-55></a><span class=go>2018-08-04 23:47:55,871 - mycodo.pid_autotune - INFO - amplitude: 0.9149999999999979</span>
</span><span id=__span-0-56><a id=__codelineno-0-56 name=__codelineno-0-56 href=#__codelineno-0-56></a><span class=go>2018-08-04 23:47:55,872 - mycodo.pid_autotune - INFO - amplitude deviation: 0.032786885245900406</span>
</span><span id=__span-0-57><a id=__codelineno-0-57 name=__codelineno-0-57 href=#__codelineno-0-57></a><span class=go>2018-08-04 23:47:55,873 - mycodo.pid_3b533dff - INFO - time:  16 min</span>
</span><span id=__span-0-58><a id=__codelineno-0-58 name=__codelineno-0-58 href=#__codelineno-0-58></a><span class=go>2018-08-04 23:47:55,874 - mycodo.pid_3b533dff - INFO - state: succeeded</span>
</span><span id=__span-0-59><a id=__codelineno-0-59 name=__codelineno-0-59 href=#__codelineno-0-59></a><span class=go>2018-08-04 23:47:55,874 - mycodo.pid_3b533dff - INFO -</span>
</span><span id=__span-0-60><a id=__codelineno-0-60 name=__codelineno-0-60 href=#__codelineno-0-60></a><span class=go>2018-08-04 23:47:55,875 - mycodo.pid_3b533dff - INFO - rule: ziegler-nichols</span>
</span><span id=__span-0-61><a id=__codelineno-0-61 name=__codelineno-0-61 href=#__codelineno-0-61></a><span class=go>2018-08-04 23:47:55,876 - mycodo.pid_3b533dff - INFO - Kp: 0.40927018474290117</span>
</span><span id=__span-0-62><a id=__codelineno-0-62 name=__codelineno-0-62 href=#__codelineno-0-62></a><span class=go>2018-08-04 23:47:55,877 - mycodo.pid_3b533dff - INFO - Ki: 0.05846588600007114</span>
</span><span id=__span-0-63><a id=__codelineno-0-63 name=__codelineno-0-63 href=#__codelineno-0-63></a><span class=go>2018-08-04 23:47:55,879 - mycodo.pid_3b533dff - INFO - Kd: 0.7162385434443115</span>
</span><span id=__span-0-64><a id=__codelineno-0-64 name=__codelineno-0-64 href=#__codelineno-0-64></a><span class=go>2018-08-04 23:47:55,880 - mycodo.pid_3b533dff - INFO -</span>
</span><span id=__span-0-65><a id=__codelineno-0-65 name=__codelineno-0-65 href=#__codelineno-0-65></a><span class=go>2018-08-04 23:47:55,881 - mycodo.pid_3b533dff - INFO - rule: tyreus-luyben</span>
</span><span id=__span-0-66><a id=__codelineno-0-66 name=__codelineno-0-66 href=#__codelineno-0-66></a><span class=go>2018-08-04 23:47:55,887 - mycodo.pid_3b533dff - INFO - Kp: 0.3162542336649691</span>
</span><span id=__span-0-67><a id=__codelineno-0-67 name=__codelineno-0-67 href=#__codelineno-0-67></a><span class=go>2018-08-04 23:47:55,889 - mycodo.pid_3b533dff - INFO - Ki: 0.010165091543194185</span>
</span><span id=__span-0-68><a id=__codelineno-0-68 name=__codelineno-0-68 href=#__codelineno-0-68></a><span class=go>2018-08-04 23:47:55,890 - mycodo.pid_3b533dff - INFO - Kd: 0.7028026111719073</span>
</span><span id=__span-0-69><a id=__codelineno-0-69 name=__codelineno-0-69 href=#__codelineno-0-69></a><span class=go>2018-08-04 23:47:55,891 - mycodo.pid_3b533dff - INFO -</span>
</span><span id=__span-0-70><a id=__codelineno-0-70 name=__codelineno-0-70 href=#__codelineno-0-70></a><span class=go>2018-08-04 23:47:55,892 - mycodo.pid_3b533dff - INFO - rule: ciancone-marlin</span>
</span><span id=__span-0-71><a id=__codelineno-0-71 name=__codelineno-0-71 href=#__codelineno-0-71></a><span class=go>2018-08-04 23:47:55,892 - mycodo.pid_3b533dff - INFO - Kp: 0.21083615577664605</span>
</span><span id=__span-0-72><a id=__codelineno-0-72 name=__codelineno-0-72 href=#__codelineno-0-72></a><span class=go>2018-08-04 23:47:55,893 - mycodo.pid_3b533dff - INFO - Ki: 0.06626133746674728</span>
</span><span id=__span-0-73><a id=__codelineno-0-73 name=__codelineno-0-73 href=#__codelineno-0-73></a><span class=go>2018-08-04 23:47:55,893 - mycodo.pid_3b533dff - INFO - Kd: 0.3644161687558038</span>
</span><span id=__span-0-74><a id=__codelineno-0-74 name=__codelineno-0-74 href=#__codelineno-0-74></a><span class=go>2018-08-04 23:47:55,894 - mycodo.pid_3b533dff - INFO -</span>
</span><span id=__span-0-75><a id=__codelineno-0-75 name=__codelineno-0-75 href=#__codelineno-0-75></a><span class=go>2018-08-04 23:47:55,894 - mycodo.pid_3b533dff - INFO - rule: pessen-integral</span>
</span><span id=__span-0-76><a id=__codelineno-0-76 name=__codelineno-0-76 href=#__codelineno-0-76></a><span class=go>2018-08-04 23:47:55,895 - mycodo.pid_3b533dff - INFO - Kp: 0.49697093861638</span>
</span><span id=__span-0-77><a id=__codelineno-0-77 name=__codelineno-0-77 href=#__codelineno-0-77></a><span class=go>2018-08-04 23:47:55,895 - mycodo.pid_3b533dff - INFO - Ki: 0.0887428626786794</span>
</span><span id=__span-0-78><a id=__codelineno-0-78 name=__codelineno-0-78 href=#__codelineno-0-78></a><span class=go>2018-08-04 23:47:55,896 - mycodo.pid_3b533dff - INFO - Kd: 1.04627757151908</span>
</span><span id=__span-0-79><a id=__codelineno-0-79 name=__codelineno-0-79 href=#__codelineno-0-79></a><span class=go>2018-08-04 23:47:55,896 - mycodo.pid_3b533dff - INFO -</span>
</span><span id=__span-0-80><a id=__codelineno-0-80 name=__codelineno-0-80 href=#__codelineno-0-80></a><span class=go>2018-08-04 23:47:55,897 - mycodo.pid_3b533dff - INFO - rule: some-overshoot</span>
</span><span id=__span-0-81><a id=__codelineno-0-81 name=__codelineno-0-81 href=#__codelineno-0-81></a><span class=go>2018-08-04 23:47:55,898 - mycodo.pid_3b533dff - INFO - Kp: 0.23191977135431066</span>
</span><span id=__span-0-82><a id=__codelineno-0-82 name=__codelineno-0-82 href=#__codelineno-0-82></a><span class=go>2018-08-04 23:47:55,898 - mycodo.pid_3b533dff - INFO - Ki: 0.03313066873337365</span>
</span><span id=__span-0-83><a id=__codelineno-0-83 name=__codelineno-0-83 href=#__codelineno-0-83></a><span class=go>2018-08-04 23:47:55,899 - mycodo.pid_3b533dff - INFO - Kd: 1.0823160212047374</span>
</span><span id=__span-0-84><a id=__codelineno-0-84 name=__codelineno-0-84 href=#__codelineno-0-84></a><span class=go>2018-08-04 23:47:55,899 - mycodo.pid_3b533dff - INFO -</span>
</span><span id=__span-0-85><a id=__codelineno-0-85 name=__codelineno-0-85 href=#__codelineno-0-85></a><span class=go>2018-08-04 23:47:55,900 - mycodo.pid_3b533dff - INFO - rule: no-overshoot</span>
</span><span id=__span-0-86><a id=__codelineno-0-86 name=__codelineno-0-86 href=#__codelineno-0-86></a><span class=go>2018-08-04 23:47:55,900 - mycodo.pid_3b533dff - INFO - Kp: 0.1391518628125864</span>
</span><span id=__span-0-87><a id=__codelineno-0-87 name=__codelineno-0-87 href=#__codelineno-0-87></a><span class=go>2018-08-04 23:47:55,901 - mycodo.pid_3b533dff - INFO - Ki: 0.01987840124002419</span>
</span><span id=__span-0-88><a id=__codelineno-0-88 name=__codelineno-0-88 href=#__codelineno-0-88></a><span class=go>2018-08-04 23:47:55,901 - mycodo.pid_3b533dff - INFO - Kd: 0.6493896127228425</span>
</span><span id=__span-0-89><a id=__codelineno-0-89 name=__codelineno-0-89 href=#__codelineno-0-89></a><span class=go>2018-08-04 23:47:55,902 - mycodo.pid_3b533dff - INFO -</span>
</span><span id=__span-0-90><a id=__codelineno-0-90 name=__codelineno-0-90 href=#__codelineno-0-90></a><span class=go>2018-08-04 23:47:55,902 - mycodo.pid_3b533dff - INFO - rule: brewing</span>
</span><span id=__span-0-91><a id=__codelineno-0-91 name=__codelineno-0-91 href=#__codelineno-0-91></a><span class=go>2018-08-04 23:47:55,903 - mycodo.pid_3b533dff - INFO - Kp: 5.566074512503456</span>
</span><span id=__span-0-92><a id=__codelineno-0-92 name=__codelineno-0-92 href=#__codelineno-0-92></a><span class=go>2018-08-04 23:47:55,904 - mycodo.pid_3b533dff - INFO - Ki: 0.11927040744014512</span>
</span><span id=__span-0-93><a id=__codelineno-0-93 name=__codelineno-0-93 href=#__codelineno-0-93></a><span class=go>2018-08-04 23:47:55,904 - mycodo.pid_3b533dff - INFO - Kd: 4.101408080354794</span>
</span></code></pre></div> <h2 id=conditional>Conditional<a class=headerlink href=#conditional title="Permanent link">~</a></h2> <p>Conditional Functions are used to perform simple to complex actions based a user-generated Python code. Conditional Functions allow the execution of Python 3 code as well as the use of Conditions and <a href=../Actions/ >Actions</a> within your code to interact with Mycodo. Conditions typically acquire data from Mycodo, such as Input measurements, and Actions typically affect Mycodo, such as actuating an Output or pausing a PID controller. Each Condition and Action you add will have its own description and example code to demonstrate how to use it in your Python code.</p> <div class="admonition note"> <p class=admonition-title>Note</p> <p><code>Timeout</code> must be set longer than it takes your <code>Run Python Code</code> to execute (if <code>Timeout</code> is set too low, only part of your <code>Run Python Code</code> may execute).</p> </div> <div class="admonition note"> <p class=admonition-title>Note</p> <p><code>Period</code> must be set longer than the time it takes for your <code>Run Python Code</code> to execute, otherwise it will execute again before the previous execution has finished.</p> </div> <div class="admonition note"> <p class=admonition-title>Note</p> <p>The code is executed within the same Python virtual environment that Mycodo runs from, therefore you must install Python libraries to this environment if you want them to be available to your code. This virtualenv is located at /opt/Mycodo/env and if you wanted to install, for example, "my_library" using pip, you would execute "sudo /opt/Mycodo/env/bin/pip install my_library".</p> </div> <h3 id=conditional-options>Conditional Options<a class=headerlink href=#conditional-options title="Permanent link">~</a></h3> <table> <thead> <tr class=header> <th>Setting</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td>Import Python Code</td> <td>Python 3 code that is used for importing Python libraries. This is executed before the class is created when generating the Conditional Function code.</td> </tr> <tr> <td>Initialize Python Code</td> <td>Python 3 code that is executed during the initialization of the class, within __init__(). This is where variables are initialized that will be used within the class.</td> </tr> <tr> <td>Run Python Code</td> <td>Python 3 code that will be executed every set Period. This is where the Condtions and Actions are executed. Once a Condition or Action is added, the functions that can be executed for each will be shown above each Condition or Action.</td> </tr> <tr> <td>Status Python Code</td> <td>A dictionary can be returned that allows information to be passed to other controllers and widgets. For example, the Function Status Widget will display this information on the Dashboard. This code can be removed if you do not want to return any information.</td> </tr> <tr> <td>Period (seconds)</td> <td>The period (seconds) that the Run Python Code will be executed.</td> </tr> <tr> <td>Start Offset (seconds)</td> <td>The duration (seconds) to wait before executing the Conditional for the first after it is activated.</td> </tr> <tr> <td>Log Level: Debug</td> <td>Show debug lines in the daemon log.</td> </tr> <tr> <td>Message Includes Code</td> <td>Include the Python code in the message (self.message) that is passed to Actions.</td> </tr> </tbody> </table> <p>Conditions are functions that can be used within the Run Python Code, and return specific information.</p> <table> <thead> <tr class=header> <th>Condition</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td>Measurement (Single, Last)</td> <td>Acquires the latest measurement from an Input or device. Set Max Age (seconds) to restrict how long to accept values. If the latest value is older than this duration, &quot;None&quot; is returned.</td> </tr> <tr> <td>Measurement (Single, Past, Average)</td> <td>Acquires the past measurements from an Input or device, then averages them. Set Max Age (seconds) to restrict how long to accept values. If all values are older than this duration, &quot;None&quot; is returned.</td> </tr> <tr> <td>Measurement (Single, Past, Sum)</td> <td>Acquires the past measurements from an Input or device, then sums them. Set Max Age (seconds) to restrict how long to accept values. If all values are older than this duration, &quot;None&quot; is returned.</td> </tr> <tr> <td>Measurement (Multiple, Past)</td> <td>Acquires the past measurements from an Input or device. Set Max Age (seconds) to restrict how long to accept values. If no values are found in this duration, &quot;None&quot; is returned. This differs from the &quot;Measurement (Single)&quot; Condition because it returns a list of dictionaries with 'time' and 'value' key pairs.</td> </tr> <tr> <td>GPIO State</td> <td>Acquires the current GPIO state and returns 1 if HIGH or 0 if LOW. If the latest value is older than this duration, &quot;None&quot; is returned.</td> </tr> <tr> <td>Output State</td> <td>Returns 'on' if the output is currently on, and 'off' if it's currently off.</td> </tr> <tr> <td>Output Duration On</td> <td>Returns how long the output has currently been on, in seconds. Returns 0 if off.</td> </tr> <tr> <td>Controller Running</td> <td>Returns True if the controller is active, False if inactive.</td> </tr> <tr> <td>Max Age (seconds)</td> <td>The minimum age (seconds) the measurement can be. If the last measurement is older than this, &quot;None&quot; will be returned instead of a measurement.</td> </tr> </tbody> </table> <h3 id=conditional-setup-guide>Conditional Setup Guide<a class=headerlink href=#conditional-setup-guide title="Permanent link">~</a></h3> <p>Python 3 is the environment that these conditionals will be executed. The following functions can be used within your Python code.</p> <div class="admonition note"> <p class=admonition-title>Note</p> <p>Python code indentations must use 4 spaces (not 2 spaces, tabs, or anything else).</p> </div> <table> <thead> <tr class=header> <th>Function</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td>self.condition(&quot;{ID}&quot;)</td> <td>Returns a measurement for the Condition with ID.</td> </tr> <tr> <td>self.condition_dict(&quot;{ID}&quot;)</td> <td>Returns a dictionary of measurement for the Condition with ID.</td> </tr> <tr> <td>self.run_action(&quot;{ID}&quot;)</td> <td>Executes the Action with ID.</td> </tr> <tr> <td>self.run_all_actions()</td> <td>Executes all actions.</td> </tr> <tr> <td>self.logger.info()</td> <td>Writes a log line to the Daemon log. "info" may also be changed to "warning", "error" or "debug". Debug log lines will only appear in the Daemon log when Logging Level: Debug is enabled for the Input.</td> </tr> <tr> <td>self.set_custom_option("option", value)</td> <td>Writes the value to the database for retrieval later. The option argument should be a string, and value can be a string, integer, float, list, or dictionary.</td> </tr> <tr> <td>self.get_custom_option("option")</td> <td>Reads the value from the database that was previously written with self.set_custom_option(). Returns None if the option is not found or there is no value.</td> </tr> </tbody> </table> <p>There are additional functions that can be used, but these must use the full UUID (not an abridged version as the functions above). See /opt/Mycodo/mycodo/mycodo_client.py for the functions available for use. These may be accessed via the 'control' object. An example, below, will return how long the output has been on (or 0 if it's currently off):</p> <p><code>output_on_seconds = control.output_sec_currently_on("1b6ada50-1e69-403a-9fa6-ec748b16dc23")</code></p> <p>Since the Python code must be formatted properly, it's best to familiarize yourself with the <a href=https://realpython.com/python-conditional-statements/ >basics of Python</a>.</p> <div class="admonition note"> <p class=admonition-title>Note</p> <p>There are two different IDs in use here, one set of IDs are found under the <code>Conditions</code> section of the Conditional Function, and one set of IDs are found under the <code>Actions</code> section of the Conditional Function. Read all of this section, including the examples, below, to fully understand how to properly set up a Conditional Function.</p> </div> <div class="admonition info"> <p class=admonition-title>Info</p> <p>If a measurement hasn't been acquired within the set <code>Max Age</code>, "None" will be returned when self.condition("{ID}") is called in the code. It is very important that you account for this. All examples below incorporate a test for the measurement being None, and this should not be removed. If an error occurs (such as if the statement resolves to comparing None to a numerical value, such as "if None &lt; 23"), then the code will stop there and an error will be logged in the daemon log. Accounting for None is useful for determining if an Input is no longer acquiring measurements (e.g. dead sensor, malfunction, etc.).</p> </div> <p>To create a basic conditional, follow these steps, using the numbers in the screenshots, below, that correspond to the numbers in parentheses:</p> <ul> <li>Navigate to the <code>Setup -&gt; Function</code> page.</li> <li>Select "Controller: Conditional", then click <code>Add</code>.</li> <li>Under Conditions, select a condition option, then click <code>Add Condition</code>.</li> <li>Configure the newly-added Condition then click <code>Save</code>.</li> <li>Under Actions, select an action option, then click <code>Add Action</code>.</li> <li>Configure the newly-added Action then click <code>Save</code>.</li> <li>Notice that each Condition and each Action has its own ID (underlined).</li> <li>The default Run Python Code contains placeholder IDs that need to be changed to your Condition and Action IDs. Change the ID in self.condition("asdf1234") to your Condition ID. Change the ID in self.run_action("qwer5678", message=message) to your Action ID. Click <code>Save</code> at the top of the Conditional.</li> <li>The logic used in the Run Python Code will need to be adjusted to suit your particular needs. Additionally, you may add more Conditions or Actions. See the <code>Advanced Conditional code examples</code>, below, for usage examples.</li> </ul> <p>If your Python code has been formatted correctly, your Conditional will save and it will be ready to activate. If an error is returned, your options will not have been saved. Inspect the error for which line is causing the issue and read the error message itself to try to understand what the problem is and how to fix it. There are an unfathomable number of ways to configure a Conditional, but this should hopefully get you started to developing one that suits your needs.</p> <div class="admonition note"> <p class=admonition-title>Note</p> <p>Mycodo is constantly changing, so the screenshots below may not match what you see exactly. Be sure to read this entire section of the manual to understand how to use Conditional Functions.</p> </div> <p>Beginner Conditional <code>Run Python Code</code> examples:</p> <p>Each self.condition("ID") will return the most recent measurement obtained from that particular measurement under the <code>Conditions</code> section of the Conditional Function, as long as it's within the set Max Age.</p> <div class="language-python highlight"><pre><span></span><code><span id=__span-1-1><a id=__codelineno-1-1 name=__codelineno-1-1 href=#__codelineno-1-1></a><span class=c1># Example 1, no measurement (i.e. None) returned</span>
</span><span id=__span-1-2><a id=__codelineno-1-2 name=__codelineno-1-2 href=#__codelineno-1-2></a><span class=c1># useful with the Email Notify Action to email when an Input stops working</span>
</span><span id=__span-1-3><a id=__codelineno-1-3 name=__codelineno-1-3 href=#__codelineno-1-3></a><span class=k>if</span> <span class=bp>self</span><span class=o>.</span><span class=n>condition</span><span class=p>(</span><span class=s2>&quot;asdf1234&quot;</span><span class=p>)</span> <span class=ow>is</span> <span class=kc>None</span><span class=p>:</span>
</span><span id=__span-1-4><a id=__codelineno-1-4 name=__codelineno-1-4 href=#__codelineno-1-4></a>    <span class=bp>self</span><span class=o>.</span><span class=n>run_all_actions</span><span class=p>()</span>  <span class=c1># Execute all configured actions</span>
</span><span id=__span-1-5><a id=__codelineno-1-5 name=__codelineno-1-5 href=#__codelineno-1-5></a>
</span><span id=__span-1-6><a id=__codelineno-1-6 name=__codelineno-1-6 href=#__codelineno-1-6></a><span class=c1># Example 2, test two measurement conditions</span>
</span><span id=__span-1-7><a id=__codelineno-1-7 name=__codelineno-1-7 href=#__codelineno-1-7></a><span class=n>measure_1</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>condition</span><span class=p>(</span><span class=s2>&quot;asdf1234&quot;</span><span class=p>)</span>
</span><span id=__span-1-8><a id=__codelineno-1-8 name=__codelineno-1-8 href=#__codelineno-1-8></a><span class=n>measure_2</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>condition</span><span class=p>(</span><span class=s2>&quot;hjkl5678&quot;</span><span class=p>)</span>
</span><span id=__span-1-9><a id=__codelineno-1-9 name=__codelineno-1-9 href=#__codelineno-1-9></a><span class=k>if</span> <span class=kc>None</span> <span class=ow>not</span> <span class=ow>in</span> <span class=p>[</span><span class=n>measure_1</span><span class=p>,</span> <span class=n>measure_2</span><span class=p>]:</span>
</span><span id=__span-1-10><a id=__codelineno-1-10 name=__codelineno-1-10 href=#__codelineno-1-10></a>    <span class=c1># If neither measurement is None (both are working)</span>
</span><span id=__span-1-11><a id=__codelineno-1-11 name=__codelineno-1-11 href=#__codelineno-1-11></a>    <span class=k>if</span> <span class=n>measure_1</span> <span class=o>&lt;</span> <span class=mi>20</span> <span class=ow>and</span> <span class=n>measure_2</span> <span class=o>&gt;</span> <span class=mi>10</span><span class=p>:</span>
</span><span id=__span-1-12><a id=__codelineno-1-12 name=__codelineno-1-12 href=#__codelineno-1-12></a>        <span class=c1># If measure_1 is less than 20 and measure_2 is greater than 10</span>
</span><span id=__span-1-13><a id=__codelineno-1-13 name=__codelineno-1-13 href=#__codelineno-1-13></a>        <span class=bp>self</span><span class=o>.</span><span class=n>run_all_actions</span><span class=p>()</span>  <span class=c1># Execute all configured actions</span>
</span><span id=__span-1-14><a id=__codelineno-1-14 name=__codelineno-1-14 href=#__codelineno-1-14></a>
</span><span id=__span-1-15><a id=__codelineno-1-15 name=__codelineno-1-15 href=#__codelineno-1-15></a><span class=c1># Example 3, test two measurements and sum of measurements</span>
</span><span id=__span-1-16><a id=__codelineno-1-16 name=__codelineno-1-16 href=#__codelineno-1-16></a><span class=n>measure_1</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>condition</span><span class=p>(</span><span class=s2>&quot;asdf1234&quot;</span><span class=p>)</span>
</span><span id=__span-1-17><a id=__codelineno-1-17 name=__codelineno-1-17 href=#__codelineno-1-17></a><span class=n>measure_2</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>condition</span><span class=p>(</span><span class=s2>&quot;hjkl5678&quot;</span><span class=p>)</span>
</span><span id=__span-1-18><a id=__codelineno-1-18 name=__codelineno-1-18 href=#__codelineno-1-18></a><span class=k>if</span> <span class=kc>None</span> <span class=ow>not</span> <span class=ow>in</span> <span class=p>[</span><span class=n>measure_1</span><span class=p>,</span> <span class=n>measure_2</span><span class=p>]:</span>
</span><span id=__span-1-19><a id=__codelineno-1-19 name=__codelineno-1-19 href=#__codelineno-1-19></a>    <span class=n>sum_</span> <span class=o>=</span> <span class=n>measure_1</span> <span class=o>+</span> <span class=n>measure_2</span>
</span><span id=__span-1-20><a id=__codelineno-1-20 name=__codelineno-1-20 href=#__codelineno-1-20></a>    <span class=k>if</span> <span class=n>measure_1</span> <span class=o>&gt;</span> <span class=mi>2</span> <span class=ow>and</span> <span class=mi>10</span> <span class=o>&lt;</span> <span class=n>measure_2</span> <span class=o>&lt;</span> <span class=mi>23</span> <span class=ow>and</span> <span class=n>sum_</span> <span class=o>&lt;</span> <span class=mf>30.5</span><span class=p>:</span>
</span><span id=__span-1-21><a id=__codelineno-1-21 name=__codelineno-1-21 href=#__codelineno-1-21></a>        <span class=bp>self</span><span class=o>.</span><span class=n>run_all_actions</span><span class=p>()</span>
</span><span id=__span-1-22><a id=__codelineno-1-22 name=__codelineno-1-22 href=#__codelineno-1-22></a>
</span><span id=__span-1-23><a id=__codelineno-1-23 name=__codelineno-1-23 href=#__codelineno-1-23></a><span class=c1># Example 4, combine into one conditional</span>
</span><span id=__span-1-24><a id=__codelineno-1-24 name=__codelineno-1-24 href=#__codelineno-1-24></a><span class=n>measurement</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>condition</span><span class=p>(</span><span class=s2>&quot;asdf1234&quot;</span><span class=p>)</span>
</span><span id=__span-1-25><a id=__codelineno-1-25 name=__codelineno-1-25 href=#__codelineno-1-25></a><span class=k>if</span> <span class=n>measurement</span> <span class=ow>is</span> <span class=ow>not</span> <span class=kc>None</span> <span class=ow>and</span> <span class=mi>20</span> <span class=o>&lt;</span> <span class=n>measurement</span> <span class=o>&lt;</span> <span class=mi>30</span><span class=p>:</span>  <span class=c1># combine conditions</span>
</span><span id=__span-1-26><a id=__codelineno-1-26 name=__codelineno-1-26 href=#__codelineno-1-26></a>    <span class=bp>self</span><span class=o>.</span><span class=n>run_all_actions</span><span class=p>()</span>
</span><span id=__span-1-27><a id=__codelineno-1-27 name=__codelineno-1-27 href=#__codelineno-1-27></a>
</span><span id=__span-1-28><a id=__codelineno-1-28 name=__codelineno-1-28 href=#__codelineno-1-28></a><span class=c1># Example 5, test two measurements</span>
</span><span id=__span-1-29><a id=__codelineno-1-29 name=__codelineno-1-29 href=#__codelineno-1-29></a><span class=c1># convert Edge Input from 0 or 1 to True or False</span>
</span><span id=__span-1-30><a id=__codelineno-1-30 name=__codelineno-1-30 href=#__codelineno-1-30></a><span class=n>measure_1</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>condition</span><span class=p>(</span><span class=s2>&quot;asdf1234&quot;</span><span class=p>)</span>
</span><span id=__span-1-31><a id=__codelineno-1-31 name=__codelineno-1-31 href=#__codelineno-1-31></a><span class=n>measure_2</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>condition</span><span class=p>(</span><span class=s2>&quot;hjkl5678&quot;</span><span class=p>)</span>
</span><span id=__span-1-32><a id=__codelineno-1-32 name=__codelineno-1-32 href=#__codelineno-1-32></a><span class=k>if</span> <span class=kc>None</span> <span class=ow>not</span> <span class=ow>in</span> <span class=p>[</span><span class=n>measure_1</span><span class=p>,</span> <span class=n>measure_2</span><span class=p>]:</span>
</span><span id=__span-1-33><a id=__codelineno-1-33 name=__codelineno-1-33 href=#__codelineno-1-33></a>    <span class=k>if</span> <span class=nb>bool</span><span class=p>(</span><span class=n>measure_1</span><span class=p>)</span> <span class=ow>and</span> <span class=n>measure_2</span> <span class=o>&gt;</span> <span class=mi>10</span><span class=p>:</span>
</span><span id=__span-1-34><a id=__codelineno-1-34 name=__codelineno-1-34 href=#__codelineno-1-34></a>        <span class=bp>self</span><span class=o>.</span><span class=n>run_all_actions</span><span class=p>()</span>
</span><span id=__span-1-35><a id=__codelineno-1-35 name=__codelineno-1-35 href=#__codelineno-1-35></a>
</span><span id=__span-1-36><a id=__codelineno-1-36 name=__codelineno-1-36 href=#__codelineno-1-36></a><span class=c1># Example 6, test measurement with &quot;or&quot; and a rounded measurement</span>
</span><span id=__span-1-37><a id=__codelineno-1-37 name=__codelineno-1-37 href=#__codelineno-1-37></a><span class=n>measure_1</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>condition</span><span class=p>(</span><span class=s2>&quot;asdf1234&quot;</span><span class=p>)</span>
</span><span id=__span-1-38><a id=__codelineno-1-38 name=__codelineno-1-38 href=#__codelineno-1-38></a><span class=n>measure_2</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>condition</span><span class=p>(</span><span class=s2>&quot;hjkl5678&quot;</span><span class=p>)</span>
</span><span id=__span-1-39><a id=__codelineno-1-39 name=__codelineno-1-39 href=#__codelineno-1-39></a><span class=k>if</span> <span class=kc>None</span> <span class=ow>not</span> <span class=ow>in</span> <span class=p>[</span><span class=n>measure_1</span><span class=p>,</span> <span class=n>measure_2</span><span class=p>]:</span>
</span><span id=__span-1-40><a id=__codelineno-1-40 name=__codelineno-1-40 href=#__codelineno-1-40></a>    <span class=k>if</span> <span class=n>measure_1</span> <span class=o>&gt;</span> <span class=mi>20</span> <span class=ow>or</span> <span class=nb>int</span><span class=p>(</span><span class=nb>round</span><span class=p>(</span><span class=n>measure_2</span><span class=p>))</span> <span class=ow>in</span> <span class=p>[</span><span class=mi>20</span><span class=p>,</span> <span class=mi>21</span><span class=p>,</span> <span class=mi>22</span><span class=p>]:</span>
</span><span id=__span-1-41><a id=__codelineno-1-41 name=__codelineno-1-41 href=#__codelineno-1-41></a>        <span class=bp>self</span><span class=o>.</span><span class=n>run_all_actions</span><span class=p>()</span>
</span><span id=__span-1-42><a id=__codelineno-1-42 name=__codelineno-1-42 href=#__codelineno-1-42></a>
</span><span id=__span-1-43><a id=__codelineno-1-43 name=__codelineno-1-43 href=#__codelineno-1-43></a><span class=c1># Example 7, use self to store variables across multiple executions</span>
</span><span id=__span-1-44><a id=__codelineno-1-44 name=__codelineno-1-44 href=#__codelineno-1-44></a><span class=n>measurement</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>condition</span><span class=p>(</span><span class=s2>&quot;asdf1234&quot;</span><span class=p>)</span>
</span><span id=__span-1-45><a id=__codelineno-1-45 name=__codelineno-1-45 href=#__codelineno-1-45></a><span class=k>if</span> <span class=ow>not</span> <span class=nb>hasattr</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=s2>&quot;stored_measurement&quot;</span><span class=p>):</span>  <span class=c1># Initialize variable</span>
</span><span id=__span-1-46><a id=__codelineno-1-46 name=__codelineno-1-46 href=#__codelineno-1-46></a>    <span class=bp>self</span><span class=o>.</span><span class=n>stored_measurement</span> <span class=o>=</span> <span class=n>measurement</span>
</span><span id=__span-1-47><a id=__codelineno-1-47 name=__codelineno-1-47 href=#__codelineno-1-47></a><span class=k>if</span> <span class=n>measurement</span> <span class=ow>is</span> <span class=ow>not</span> <span class=kc>None</span><span class=p>:</span>
</span><span id=__span-1-48><a id=__codelineno-1-48 name=__codelineno-1-48 href=#__codelineno-1-48></a>    <span class=k>if</span> <span class=nb>abs</span><span class=p>(</span><span class=n>measurement</span> <span class=o>-</span> <span class=bp>self</span><span class=o>.</span><span class=n>stored_measurement</span><span class=p>)</span> <span class=o>&gt;</span> <span class=mi>10</span><span class=p>:</span>
</span><span id=__span-1-49><a id=__codelineno-1-49 name=__codelineno-1-49 href=#__codelineno-1-49></a>        <span class=bp>self</span><span class=o>.</span><span class=n>run_all_actions</span><span class=p>()</span>  <span class=c1># if difference is greater than 10</span>
</span><span id=__span-1-50><a id=__codelineno-1-50 name=__codelineno-1-50 href=#__codelineno-1-50></a>    <span class=bp>self</span><span class=o>.</span><span class=n>stored_measurement</span> <span class=o>=</span> <span class=n>measurement</span>  <span class=c1># Store measurement</span>
</span></code></pre></div> <p>The "Measurement (Multiple)" Condition is useful if you desire to check if a particular value has been stored in any of the past measurements (within the set Max Age), not just the last measurement. This is useful if you have an alert system that each numerical value represents a different alert that you need to check each past value if it occurred. Here is an example that retrieves all measurements from the past 30 minutes and checks if any of the measurements in the returned list is equal to "119". If "119" exists, the Actions are executed and <code>break</code> is used to exit the <code>for</code> loop.</p> <div class="language-python highlight"><pre><span></span><code><span id=__span-2-1><a id=__codelineno-2-1 name=__codelineno-2-1 href=#__codelineno-2-1></a><span class=c1># Example 1, find a measurement in the past 30 minutes (Max Age: 1800 seconds)</span>
</span><span id=__span-2-2><a id=__codelineno-2-2 name=__codelineno-2-2 href=#__codelineno-2-2></a><span class=n>measurements</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>condition_dict</span><span class=p>(</span><span class=s2>&quot;asdf1234&quot;</span><span class=p>)</span>
</span><span id=__span-2-3><a id=__codelineno-2-3 name=__codelineno-2-3 href=#__codelineno-2-3></a><span class=k>if</span> <span class=n>measurements</span><span class=p>:</span>  <span class=c1># If the list is not empty</span>
</span><span id=__span-2-4><a id=__codelineno-2-4 name=__codelineno-2-4 href=#__codelineno-2-4></a>    <span class=k>for</span> <span class=n>each_measure</span> <span class=ow>in</span> <span class=n>measurements</span><span class=p>:</span>  <span class=c1># Loop through each measurement in the list</span>
</span><span id=__span-2-5><a id=__codelineno-2-5 name=__codelineno-2-5 href=#__codelineno-2-5></a>        <span class=k>if</span> <span class=n>each_measure</span><span class=p>[</span><span class=s1>&#39;value&#39;</span><span class=p>]</span> <span class=o>==</span> <span class=mi>119</span><span class=p>:</span>
</span><span id=__span-2-6><a id=__codelineno-2-6 name=__codelineno-2-6 href=#__codelineno-2-6></a>            <span class=bp>self</span><span class=o>.</span><span class=n>logger</span><span class=o>.</span><span class=n>info</span><span class=p>(</span><span class=s2>&quot;Alert 119 found at timestamp </span><span class=si>{time}</span><span class=s2>&quot;</span><span class=o>.</span><span class=n>format</span><span class=p>(</span>
</span><span id=__span-2-7><a id=__codelineno-2-7 name=__codelineno-2-7 href=#__codelineno-2-7></a>                <span class=n>time</span><span class=o>=</span><span class=n>each_measure</span><span class=p>[</span><span class=s1>&#39;time&#39;</span><span class=p>]))</span>
</span><span id=__span-2-8><a id=__codelineno-2-8 name=__codelineno-2-8 href=#__codelineno-2-8></a>            <span class=bp>self</span><span class=o>.</span><span class=n>run_all_actions</span><span class=p>()</span>
</span><span id=__span-2-9><a id=__codelineno-2-9 name=__codelineno-2-9 href=#__codelineno-2-9></a>            <span class=k>break</span>  <span class=c1># Exit the for loop</span>
</span></code></pre></div> <p>Advanced Conditional <code>Run Python Code</code> examples:</p> <p>These examples expand on the beginner examples, above, by activating specific actions. The following examples will reference actions with IDs that can be found under the <code>Actions</code> section of the Conditional Function. Two example action IDs will be used: "qwer1234" and "uiop5678". Additionally, self.run_all_actions() is used here, which will run all actions in the order in which they were created.</p> <div class="language-python highlight"><pre><span></span><code><span id=__span-3-1><a id=__codelineno-3-1 name=__codelineno-3-1 href=#__codelineno-3-1></a><span class=c1># Example 1</span>
</span><span id=__span-3-2><a id=__codelineno-3-2 name=__codelineno-3-2 href=#__codelineno-3-2></a><span class=n>measurement</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>condition</span><span class=p>(</span><span class=s2>&quot;asdf1234&quot;</span><span class=p>)</span>
</span><span id=__span-3-3><a id=__codelineno-3-3 name=__codelineno-3-3 href=#__codelineno-3-3></a><span class=k>if</span> <span class=n>measurement</span> <span class=ow>is</span> <span class=kc>None</span><span class=p>:</span>
</span><span id=__span-3-4><a id=__codelineno-3-4 name=__codelineno-3-4 href=#__codelineno-3-4></a>    <span class=bp>self</span><span class=o>.</span><span class=n>run_action</span><span class=p>(</span><span class=s2>&quot;qwer1234&quot;</span><span class=p>)</span>
</span><span id=__span-3-5><a id=__codelineno-3-5 name=__codelineno-3-5 href=#__codelineno-3-5></a><span class=k>elif</span> <span class=n>measurement</span> <span class=o>&gt;</span> <span class=mi>23</span><span class=p>:</span>
</span><span id=__span-3-6><a id=__codelineno-3-6 name=__codelineno-3-6 href=#__codelineno-3-6></a>    <span class=bp>self</span><span class=o>.</span><span class=n>run_action</span><span class=p>(</span><span class=s2>&quot;uiop5678&quot;</span><span class=p>)</span>
</span><span id=__span-3-7><a id=__codelineno-3-7 name=__codelineno-3-7 href=#__codelineno-3-7></a><span class=k>else</span><span class=p>:</span>
</span><span id=__span-3-8><a id=__codelineno-3-8 name=__codelineno-3-8 href=#__codelineno-3-8></a>    <span class=bp>self</span><span class=o>.</span><span class=n>run_all_actions</span><span class=p>()</span>
</span><span id=__span-3-9><a id=__codelineno-3-9 name=__codelineno-3-9 href=#__codelineno-3-9></a>
</span><span id=__span-3-10><a id=__codelineno-3-10 name=__codelineno-3-10 href=#__codelineno-3-10></a><span class=c1># Example 2, test two measurements</span>
</span><span id=__span-3-11><a id=__codelineno-3-11 name=__codelineno-3-11 href=#__codelineno-3-11></a><span class=n>measure_1</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>condition</span><span class=p>(</span><span class=s2>&quot;asdf1234&quot;</span><span class=p>)</span>
</span><span id=__span-3-12><a id=__codelineno-3-12 name=__codelineno-3-12 href=#__codelineno-3-12></a><span class=n>measure_2</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>condition</span><span class=p>(</span><span class=s2>&quot;hjkl5678&quot;</span><span class=p>)</span>
</span><span id=__span-3-13><a id=__codelineno-3-13 name=__codelineno-3-13 href=#__codelineno-3-13></a><span class=k>if</span> <span class=kc>None</span> <span class=ow>not</span> <span class=ow>in</span> <span class=p>[</span><span class=n>measure_1</span><span class=p>,</span> <span class=n>measure_2</span><span class=p>]:</span>
</span><span id=__span-3-14><a id=__codelineno-3-14 name=__codelineno-3-14 href=#__codelineno-3-14></a>    <span class=k>if</span> <span class=n>measure_1</span> <span class=o>&lt;</span> <span class=mi>20</span> <span class=ow>and</span> <span class=n>measure_2</span> <span class=o>&gt;</span> <span class=mi>10</span><span class=p>:</span>
</span><span id=__span-3-15><a id=__codelineno-3-15 name=__codelineno-3-15 href=#__codelineno-3-15></a>        <span class=bp>self</span><span class=o>.</span><span class=n>run_action</span><span class=p>(</span><span class=s2>&quot;qwer1234&quot;</span><span class=p>)</span>
</span><span id=__span-3-16><a id=__codelineno-3-16 name=__codelineno-3-16 href=#__codelineno-3-16></a>        <span class=bp>self</span><span class=o>.</span><span class=n>run_action</span><span class=p>(</span><span class=s2>&quot;uiop5678&quot;</span><span class=p>)</span>
</span><span id=__span-3-17><a id=__codelineno-3-17 name=__codelineno-3-17 href=#__codelineno-3-17></a>
</span><span id=__span-3-18><a id=__codelineno-3-18 name=__codelineno-3-18 href=#__codelineno-3-18></a><span class=c1># Example 3, test two measurements and sum of measurements</span>
</span><span id=__span-3-19><a id=__codelineno-3-19 name=__codelineno-3-19 href=#__codelineno-3-19></a><span class=n>measure_1</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>condition</span><span class=p>(</span><span class=s2>&quot;asdf1234&quot;</span><span class=p>)</span>
</span><span id=__span-3-20><a id=__codelineno-3-20 name=__codelineno-3-20 href=#__codelineno-3-20></a><span class=n>measure_2</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>condition</span><span class=p>(</span><span class=s2>&quot;hjkl5678&quot;</span><span class=p>)</span>
</span><span id=__span-3-21><a id=__codelineno-3-21 name=__codelineno-3-21 href=#__codelineno-3-21></a><span class=k>if</span> <span class=kc>None</span> <span class=ow>not</span> <span class=ow>in</span> <span class=p>[</span><span class=n>measure_1</span><span class=p>,</span> <span class=n>measure_2</span><span class=p>]:</span>
</span><span id=__span-3-22><a id=__codelineno-3-22 name=__codelineno-3-22 href=#__codelineno-3-22></a>    <span class=n>sum_</span> <span class=o>=</span> <span class=n>measure_1</span> <span class=o>+</span> <span class=n>measure_2</span>
</span><span id=__span-3-23><a id=__codelineno-3-23 name=__codelineno-3-23 href=#__codelineno-3-23></a>    <span class=k>if</span> <span class=n>measure_1</span> <span class=o>&gt;</span> <span class=mi>2</span> <span class=ow>and</span> <span class=mi>10</span> <span class=o>&lt;</span> <span class=n>measure_2</span> <span class=o>&lt;</span> <span class=mi>23</span> <span class=ow>and</span> <span class=n>sum_</span> <span class=o>&lt;</span> <span class=mf>30.5</span><span class=p>:</span>
</span><span id=__span-3-24><a id=__codelineno-3-24 name=__codelineno-3-24 href=#__codelineno-3-24></a>        <span class=bp>self</span><span class=o>.</span><span class=n>run_action</span><span class=p>(</span><span class=s2>&quot;qwer1234&quot;</span><span class=p>)</span>
</span><span id=__span-3-25><a id=__codelineno-3-25 name=__codelineno-3-25 href=#__codelineno-3-25></a>    <span class=k>else</span><span class=p>:</span>
</span><span id=__span-3-26><a id=__codelineno-3-26 name=__codelineno-3-26 href=#__codelineno-3-26></a>        <span class=bp>self</span><span class=o>.</span><span class=n>run_action</span><span class=p>(</span><span class=s2>&quot;uiop5678&quot;</span><span class=p>)</span>
</span><span id=__span-3-27><a id=__codelineno-3-27 name=__codelineno-3-27 href=#__codelineno-3-27></a>
</span><span id=__span-3-28><a id=__codelineno-3-28 name=__codelineno-3-28 href=#__codelineno-3-28></a><span class=c1># Example 4, combine into one conditional</span>
</span><span id=__span-3-29><a id=__codelineno-3-29 name=__codelineno-3-29 href=#__codelineno-3-29></a><span class=n>measurement</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>condition</span><span class=p>(</span><span class=s2>&quot;asdf1234&quot;</span><span class=p>)</span>
</span><span id=__span-3-30><a id=__codelineno-3-30 name=__codelineno-3-30 href=#__codelineno-3-30></a><span class=k>if</span> <span class=n>measurement</span> <span class=ow>is</span> <span class=ow>not</span> <span class=kc>None</span> <span class=ow>and</span> <span class=mi>20</span> <span class=o>&lt;</span> <span class=n>measurement</span> <span class=o>&lt;</span> <span class=mi>30</span><span class=p>:</span>
</span><span id=__span-3-31><a id=__codelineno-3-31 name=__codelineno-3-31 href=#__codelineno-3-31></a>    <span class=bp>self</span><span class=o>.</span><span class=n>run_action</span><span class=p>(</span><span class=s2>&quot;uiop5678&quot;</span><span class=p>)</span>
</span><span id=__span-3-32><a id=__codelineno-3-32 name=__codelineno-3-32 href=#__codelineno-3-32></a>
</span><span id=__span-3-33><a id=__codelineno-3-33 name=__codelineno-3-33 href=#__codelineno-3-33></a><span class=c1># Example 5, test two measurements, convert Edge Input from 0/1 to True/False</span>
</span><span id=__span-3-34><a id=__codelineno-3-34 name=__codelineno-3-34 href=#__codelineno-3-34></a><span class=n>measure_1</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>condition</span><span class=p>(</span><span class=s2>&quot;asdf1234&quot;</span><span class=p>)</span>
</span><span id=__span-3-35><a id=__codelineno-3-35 name=__codelineno-3-35 href=#__codelineno-3-35></a><span class=n>measure_2</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>condition</span><span class=p>(</span><span class=s2>&quot;hjkl5678&quot;</span><span class=p>)</span>
</span><span id=__span-3-36><a id=__codelineno-3-36 name=__codelineno-3-36 href=#__codelineno-3-36></a><span class=k>if</span> <span class=kc>None</span> <span class=ow>not</span> <span class=ow>in</span> <span class=p>[</span><span class=n>measure_1</span><span class=p>,</span> <span class=n>measure_2</span><span class=p>]:</span>
</span><span id=__span-3-37><a id=__codelineno-3-37 name=__codelineno-3-37 href=#__codelineno-3-37></a>    <span class=k>if</span> <span class=nb>bool</span><span class=p>(</span><span class=n>measure_1</span><span class=p>)</span> <span class=ow>and</span> <span class=n>measure_2</span> <span class=o>&gt;</span> <span class=mi>10</span><span class=p>:</span>
</span><span id=__span-3-38><a id=__codelineno-3-38 name=__codelineno-3-38 href=#__codelineno-3-38></a>        <span class=bp>self</span><span class=o>.</span><span class=n>run_all_actions</span><span class=p>()</span>
</span><span id=__span-3-39><a id=__codelineno-3-39 name=__codelineno-3-39 href=#__codelineno-3-39></a>
</span><span id=__span-3-40><a id=__codelineno-3-40 name=__codelineno-3-40 href=#__codelineno-3-40></a><span class=c1># Example 6, test measurement with &quot;or&quot; and a rounded measurement</span>
</span><span id=__span-3-41><a id=__codelineno-3-41 name=__codelineno-3-41 href=#__codelineno-3-41></a><span class=n>measure_1</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>measure</span><span class=p>(</span><span class=s2>&quot;asdf1234&quot;</span><span class=p>)</span>
</span><span id=__span-3-42><a id=__codelineno-3-42 name=__codelineno-3-42 href=#__codelineno-3-42></a><span class=n>measure_2</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>measure</span><span class=p>(</span><span class=s2>&quot;hjkl5678&quot;</span><span class=p>)</span>
</span><span id=__span-3-43><a id=__codelineno-3-43 name=__codelineno-3-43 href=#__codelineno-3-43></a><span class=k>if</span> <span class=kc>None</span> <span class=ow>not</span> <span class=ow>in</span> <span class=p>[</span><span class=n>measure_1</span><span class=p>,</span> <span class=n>measure_2</span><span class=p>]:</span>
</span><span id=__span-3-44><a id=__codelineno-3-44 name=__codelineno-3-44 href=#__codelineno-3-44></a>    <span class=k>if</span> <span class=n>measure_1</span> <span class=o>&gt;</span> <span class=mi>20</span> <span class=ow>or</span> <span class=nb>int</span><span class=p>(</span><span class=nb>round</span><span class=p>(</span><span class=n>measure_2</span><span class=p>))</span> <span class=ow>in</span> <span class=p>[</span><span class=mi>20</span><span class=p>,</span> <span class=mi>21</span><span class=p>,</span> <span class=mi>22</span><span class=p>]:</span>
</span><span id=__span-3-45><a id=__codelineno-3-45 name=__codelineno-3-45 href=#__codelineno-3-45></a>        <span class=bp>self</span><span class=o>.</span><span class=n>run_action</span><span class=p>(</span><span class=s2>&quot;qwer1234&quot;</span><span class=p>)</span>
</span><span id=__span-3-46><a id=__codelineno-3-46 name=__codelineno-3-46 href=#__codelineno-3-46></a>        <span class=k>if</span> <span class=n>measure_1</span> <span class=o>&gt;</span> <span class=mi>30</span><span class=p>:</span>
</span><span id=__span-3-47><a id=__codelineno-3-47 name=__codelineno-3-47 href=#__codelineno-3-47></a>            <span class=bp>self</span><span class=o>.</span><span class=n>run_action</span><span class=p>(</span><span class=s2>&quot;uiop5678&quot;</span><span class=p>)</span>
</span></code></pre></div> <p>If your Action is a type that receives a message (E-Mail or Note), you can modify this message to include extra information before it is passed to the function (so the new information is passed to the Note, E-Mail, etc.). To do this, append a string to the variable <code>self.message</code> and add this to the <code>message</code> parameter of self.run_action() or self.run_all_actions(). Below are some examples. Note the use of "+=" instead of "=", which appends the string to the variable <code>self.message</code> instead of overwriting it.</p> <div class="language-python highlight"><pre><span></span><code><span id=__span-4-1><a id=__codelineno-4-1 name=__codelineno-4-1 href=#__codelineno-4-1></a><span class=c1># Example 1</span>
</span><span id=__span-4-2><a id=__codelineno-4-2 name=__codelineno-4-2 href=#__codelineno-4-2></a><span class=n>measurement</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>measure</span><span class=p>(</span><span class=s2>&quot;asdf1234&quot;</span><span class=p>)</span>
</span><span id=__span-4-3><a id=__codelineno-4-3 name=__codelineno-4-3 href=#__codelineno-4-3></a><span class=k>if</span> <span class=n>measurement</span> <span class=ow>is</span> <span class=kc>None</span> <span class=ow>and</span> <span class=n>measurement</span> <span class=o>&gt;</span> <span class=mi>23</span><span class=p>:</span>
</span><span id=__span-4-4><a id=__codelineno-4-4 name=__codelineno-4-4 href=#__codelineno-4-4></a>    <span class=bp>self</span><span class=o>.</span><span class=n>message</span> <span class=o>+=</span> <span class=s2>&quot;Measurement was </span><span class=si>{}</span><span class=s2>&quot;</span><span class=o>.</span><span class=n>format</span><span class=p>(</span><span class=n>measurement</span><span class=p>)</span>
</span><span id=__span-4-5><a id=__codelineno-4-5 name=__codelineno-4-5 href=#__codelineno-4-5></a>    <span class=bp>self</span><span class=o>.</span><span class=n>run_action</span><span class=p>(</span><span class=s2>&quot;uiop5678}&quot;</span><span class=p>,</span> <span class=n>message</span><span class=o>=</span><span class=bp>self</span><span class=o>.</span><span class=n>message</span><span class=p>)</span>
</span><span id=__span-4-6><a id=__codelineno-4-6 name=__codelineno-4-6 href=#__codelineno-4-6></a>
</span><span id=__span-4-7><a id=__codelineno-4-7 name=__codelineno-4-7 href=#__codelineno-4-7></a><span class=c1># Example 2</span>
</span><span id=__span-4-8><a id=__codelineno-4-8 name=__codelineno-4-8 href=#__codelineno-4-8></a><span class=n>measure_1</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>measure</span><span class=p>(</span><span class=s2>&quot;asdf1234&quot;</span><span class=p>)</span>
</span><span id=__span-4-9><a id=__codelineno-4-9 name=__codelineno-4-9 href=#__codelineno-4-9></a><span class=n>measure_2</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>measure</span><span class=p>(</span><span class=s2>&quot;hjkl5678&quot;</span><span class=p>)</span>
</span><span id=__span-4-10><a id=__codelineno-4-10 name=__codelineno-4-10 href=#__codelineno-4-10></a><span class=k>if</span> <span class=kc>None</span> <span class=ow>not</span> <span class=ow>in</span> <span class=p>[</span><span class=n>measure_1</span><span class=p>,</span> <span class=n>measure_2</span><span class=p>]:</span>
</span><span id=__span-4-11><a id=__codelineno-4-11 name=__codelineno-4-11 href=#__codelineno-4-11></a>    <span class=k>if</span> <span class=n>measure_1</span> <span class=o>&lt;</span> <span class=mi>20</span> <span class=ow>and</span> <span class=n>measure_2</span> <span class=o>&gt;</span> <span class=mi>10</span><span class=p>:</span>
</span><span id=__span-4-12><a id=__codelineno-4-12 name=__codelineno-4-12 href=#__codelineno-4-12></a>        <span class=bp>self</span><span class=o>.</span><span class=n>message</span> <span class=o>+=</span> <span class=s2>&quot;Measurement 1: </span><span class=si>{m1}</span><span class=s2>, Measurement 2: </span><span class=si>{m2}</span><span class=s2>&quot;</span><span class=o>.</span><span class=n>format</span><span class=p>(</span>
</span><span id=__span-4-13><a id=__codelineno-4-13 name=__codelineno-4-13 href=#__codelineno-4-13></a>            <span class=n>m1</span><span class=o>=</span><span class=n>measure_1</span><span class=p>,</span> <span class=n>m2</span><span class=o>=</span><span class=n>measure_2</span><span class=p>)</span>
</span><span id=__span-4-14><a id=__codelineno-4-14 name=__codelineno-4-14 href=#__codelineno-4-14></a>        <span class=bp>self</span><span class=o>.</span><span class=n>run_all_actions</span><span class=p>(</span><span class=n>message</span><span class=o>=</span><span class=bp>self</span><span class=o>.</span><span class=n>message</span><span class=p>)</span>
</span></code></pre></div> <p>Logging can also be used to log messages to the daemon log using <code>self.logger</code>. Logging levels include "info", "warning", "error" and "debug". Debug log lines will only appear in the Daemon log when Logging Level: Debug is enabled for the Input.</p> <div class="language-python highlight"><pre><span></span><code><span id=__span-5-1><a id=__codelineno-5-1 name=__codelineno-5-1 href=#__codelineno-5-1></a><span class=c1># Example 1</span>
</span><span id=__span-5-2><a id=__codelineno-5-2 name=__codelineno-5-2 href=#__codelineno-5-2></a><span class=n>measurement</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>measure</span><span class=p>(</span><span class=s2>&quot;asdf1234&quot;</span><span class=p>)</span>
</span><span id=__span-5-3><a id=__codelineno-5-3 name=__codelineno-5-3 href=#__codelineno-5-3></a><span class=k>if</span> <span class=n>measurement</span> <span class=ow>is</span> <span class=kc>None</span> <span class=ow>and</span> <span class=n>measurement</span> <span class=o>&gt;</span> <span class=mi>23</span><span class=p>:</span>
</span><span id=__span-5-4><a id=__codelineno-5-4 name=__codelineno-5-4 href=#__codelineno-5-4></a>    <span class=bp>self</span><span class=o>.</span><span class=n>logging</span><span class=o>.</span><span class=n>error</span><span class=p>(</span><span class=s2>&quot;Warning, measurement was </span><span class=si>{}</span><span class=s2>&quot;</span><span class=o>.</span><span class=n>format</span><span class=p>(</span><span class=n>measurement</span><span class=p>))</span>
</span><span id=__span-5-5><a id=__codelineno-5-5 name=__codelineno-5-5 href=#__codelineno-5-5></a>    <span class=bp>self</span><span class=o>.</span><span class=n>message</span> <span class=o>+=</span> <span class=s2>&quot;Measurement was </span><span class=si>{}</span><span class=s2>&quot;</span><span class=o>.</span><span class=n>format</span><span class=p>(</span><span class=n>measurement</span><span class=p>)</span>
</span><span id=__span-5-6><a id=__codelineno-5-6 name=__codelineno-5-6 href=#__codelineno-5-6></a>    <span class=bp>self</span><span class=o>.</span><span class=n>run_action</span><span class=p>(</span><span class=s2>&quot;uiop5678}&quot;</span><span class=p>,</span> <span class=n>message</span><span class=o>=</span><span class=bp>self</span><span class=o>.</span><span class=n>message</span><span class=p>)</span>
</span></code></pre></div> <p>Before activating any conditionals, it's advised to thoroughly explore all possible scenarios and plan a configuration that eliminates conflicts. Some devices or outputs may respond atypically or fail when switched on and off in rapid succession. Therefore, trial run your configuration before connecting devices to any outputs.</p> <h2 id=trigger>Trigger<a class=headerlink href=#trigger title="Permanent link">~</a></h2> <p>A Trigger Controller will execute actions when events are triggered, such as an output turning on or off, a GPIO pin changing it's voltage state (Edge detection, rising or falling), timed events that include various timers (duration, time period, time point, etc), or the sunrise/sunset time at a specific latitude and longitude. Once the trigger is configured, add any number of <a href=../Actions/ >Actions</a> to be executed when that event is triggered.</p> <h3 id=output-onoff-options>Output (On/Off) Options<a class=headerlink href=#output-onoff-options title="Permanent link">~</a></h3> <p>Monitor the state of an output.</p> <table> <thead> <tr class=header> <th>Setting</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td>If Output</td> <td>The Output to monitor for a change of state.</td> </tr> <tr> <td>If State</td> <td>If the state of the output changes to On or Off the conditional will trigger. If &quot;On (any duration) is selected, th trigger will occur no matter how long the output turns on for, whereas if only &quot;On&quot; is selected, the conditional will trigger only when the output turns on for a duration of time equal to the set &quot;Duration (seconds)&quot;.</td> </tr> <tr> <td>If Duration (seconds)</td> <td>If &quot;On&quot; is selected, an optional duration (seconds) may be set that will trigger the conditional only if the Output is turned on for this specific duration.</td> </tr> </tbody> </table> <h3 id=output-pwm-options>Output (PWM) Options<a class=headerlink href=#output-pwm-options title="Permanent link">~</a></h3> <p>Monitor the state of a PWM output.</p> <table> <thead> <tr class=header> <th>Setting</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td>If Output</td> <td>The Output to monitor for a change of state.</td> </tr> <tr> <td>If State</td> <td>If the duty cycle of the output is greater than,less than, or equal to the set value, trigger the Conditional Actions.</td> </tr> <tr> <td>If Duty Cycle (%)</td> <td>The duty cycle for the Output to be checked against.</td> </tr> </tbody> </table> <h3 id=edge-options>Edge Options<a class=headerlink href=#edge-options title="Permanent link">~</a></h3> <p>Monitor the state of a pin for a rising and/or falling edge.</p> <table> <thead> <tr class=header> <th>Setting</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td>If Edge Detected</td> <td>The conditional will be triggered if a change in state is detected, either Rising when the state changes from LOW (0 volts) to HIGH (3.5 volts) or Falling when the state changes from HIGH (3.3 volts) to LOW (0 volts), or Both (Rising and Falling).</td> </tr> </tbody> </table> <h3 id=run-pwm-method-options>Run PWM Method Options<a class=headerlink href=#run-pwm-method-options title="Permanent link">~</a></h3> <p>Select a Duration Method and this will set the selected PWM Output to the duty cycle specified by the method.</p> <table> <thead> <tr class=header> <th>Setting</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td>Duration Method</td> <td>Select which Method to use.</td> </tr> <tr> <td>PWM Output</td> <td>Select which PWM Output to use.</td> </tr> <tr> <td>Period (seconds)</td> <td>Select the interval of time to calculate the duty cycle, then apply to the PWM Output.</td> </tr> <tr> <td>Trigger Every Period</td> <td>Trigger Conditional Actions every period.</td> </tr> <tr> <td>Trigger when Activated</td> <td>Trigger Conditional Actions when the Conditional is activated.</td> </tr> </tbody> </table> <h3 id=sunrisesunset-options>Sunrise/Sunset Options<a class=headerlink href=#sunrisesunset-options title="Permanent link">~</a></h3> <p>Trigger events at sunrise or sunset (or a time offset of those), based on latitude and longitude.</p> <table> <thead> <tr class=header> <th>Setting</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td>Rise or Set</td> <td>Select which to trigger the conditional, at sunrise or sunset.</td> </tr> <tr> <td>Latitude (decimal)</td> <td>Latitude of the sunrise/sunset, using decimal format.</td> </tr> <tr> <td>Longitude (decimal)</td> <td>Longitude of the sunrise/sunset, using decimal format.</td> </tr> <tr> <td>Zenith</td> <td>The Zenith angle of the sun.</td> </tr> <tr> <td>Date Offset (days)</td> <td>Set a sunrise/sunset offset in days (positive or negative).</td> </tr> <tr> <td>Time Offset (minutes)</td> <td>Set a sunrise/sunset offset in minutes (positive or negative).</td> </tr> </tbody> </table> <h3 id=timer-duration-options>Timer (Duration) Options<a class=headerlink href=#timer-duration-options title="Permanent link">~</a></h3> <p>Run a timer that triggers Conditional Actions every period.</p> <table> <thead> <tr class=header> <th>Setting</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td>Period (seconds)</td> <td>The period of time between triggering Conditional Actions.</td> </tr> <tr> <td>Start Offset (seconds)</td> <td>Set this to start the first trigger a number of seconds after the Conditional is activated.</td> </tr> </tbody> </table> <h3 id=timer-daily-time-point-options>Timer (Daily Time Point) Options<a class=headerlink href=#timer-daily-time-point-options title="Permanent link">~</a></h3> <p>Run a timer that triggers Conditional Actions at a specific time every day.</p> <p><table &lt;thead> <tr class=header> <th>Setting</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td>Start Time (HH:MM)</td> <td>Set the time to trigger Conditional Actions, in the format &quot;HH:MM&quot;, with HH denoting hours, and MM denoting minutes. Time is in 24-hour format.</td> </tr> </tbody> </table> </p> <h3 id=timer-daily-time-span-options>Timer (Daily Time Span) Options<a class=headerlink href=#timer-daily-time-span-options title="Permanent link">~</a></h3> <p>Run a timer that triggers Conditional Actions at a specific period if it's between the set start and end times. For example, if the Start Time is set to 10:00 and End Time set to 11:00 and Period set to 120 seconds, the Conditional Actions will trigger every 120 seconds when the time is between 10 AM and 11 AM.</p> <p>This may be useful, for instance, if you desire an Output to remain on during a particular time period and you want to prevent power outages from interrupting the cycle (which a simple Time Point Timer could not prevent against because it only triggers once at the Start Time). By setting an Output to turn the lights on every few minutes during the Start -&gt; End period, it ensured the Output remains on during this period.</p> <table> <thead> <tr class=header> <th>Setting</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td>Start Time (HH:MM)</td> <td>Set the start time to trigger Conditional Actions, in the format &quot;HH:MM&quot;, with HH denoting hours, and MM denoting minutes. Time is in 24-hour format.</td> </tr> <tr> <td>End Time (HH:MM)</td> <td>Set the end time to trigger Conditional Actions, in the format &quot;HH:MM&quot;, with HH denoting hours, and MM denoting minutes. Time is in 24-hour format.</td> </tr> <tr> <td>Period (seconds)</td> <td>The period of time between triggering Conditional Actions.</td> </tr> </tbody> </table> </article> </div> <script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script> </div> <button type=button class="md-top md-icon" data-md-component=top hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg> Back to top </button> </main> <footer class=md-footer> <div class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <div class=md-copyright> Made with <a href=https://squidfunk.github.io/mkdocs-material/ target=_blank rel=noopener> Material for MkDocs </a> </div> </div> </div> </footer> </div> <div class=md-dialog data-md-component=dialog> <div class="md-dialog__inner md-typeset"></div> </div> <script id=__config type=application/json>{"base": "..", "features": ["navigation.tabs", "navigation.top"], "search": "../assets/javascripts/workers/search.6ce7567c.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": "8.16.0"}</script> <script src=../assets/javascripts/bundle.525ec568.min.js></script> </body> </html>